<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>× ×™×”×•×œ ×× ×•×™×™ ×”×ª×¨××•×ª WhatsApp - ××” ×™×© ×¤×”?</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Assistant:wght@400;600;700&display=swap');
        
        :root {
            --primary-color: #F69898;
            --primary-light: #ffb6c1;
            --primary-dark: #e58080;
            --whatsapp-color: #25D366;
            --dark-bg: #333333;
            --darker-bg: #222222;
            --text-light: #ffffff;
            --text-muted: #cccccc;
            --border-radius: 12px;
            --transition: all 0.3s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Assistant', Arial, sans-serif;
        }

        body {
            background-color: #000;
            color: white;
            direction: rtl;
            line-height: 1.6;
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            padding: 30px 0;
            background: linear-gradient(145deg, var(--dark-bg) 0%, var(--darker-bg) 100%);
            border-radius: var(--border-radius);
            margin-bottom: 30px;
        }

        .header h1 {
            color: var(--primary-color);
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.1rem;
            color: var(--text-muted);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: linear-gradient(135deg, var(--primary-color), var(--primary-light));
            padding: 25px;
            border-radius: var(--border-radius);
            text-align: center;
            color: white;
            box-shadow: 0 4px 15px rgba(246, 152, 152, 0.3);
        }

        .stat-number {
            font-size: 2.5rem;
            font-weight: bold;
            margin-bottom: 5px;
            display: block;
        }

        .stat-label {
            font-size: 1rem;
            opacity: 0.9;
        }

        .admin-section, .section {
            background: linear-gradient(145deg, var(--dark-bg), var(--darker-bg));
            padding: 30px;
            border-radius: var(--border-radius);
            margin-bottom: 30px;
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.2);
            border: 2px solid rgba(246, 152, 152, 0.2);
        }

        .section-header {
            margin-bottom: 20px;
        }

        .section-title, .section h2 {
            color: var(--primary-color);
            font-size: 1.5rem;
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
        }

        .action-buttons {
            display: flex;
            gap: 15px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }

        .btn {
            background: linear-gradient(135deg, var(--primary-color), var(--primary-light));
            color: white;
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            transition: var(--transition);
            box-shadow: 0 4px 12px rgba(246,152,152,0.3);
        }

        .btn:hover {
            background: linear-gradient(135deg, var(--primary-dark), var(--primary-color));
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(246,152,152,0.4);
        }

        .btn-secondary {
            background: linear-gradient(135deg, var(--whatsapp-color), #128C7E);
            box-shadow: 0 4px 12px rgba(37, 211, 102, 0.3);
        }

        .btn-secondary:hover {
            background: linear-gradient(135deg, #128C7E, #0f6b5c);
            box-shadow: 0 6px 15px rgba(37, 211, 102, 0.4);
        }

        .btn-danger {
            background: linear-gradient(135deg, #dc3545, #c82333);
        }

        .btn-danger:hover {
            background: linear-gradient(135deg, #c82333, #a71e2a);
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label, .form-label {
            display: block;
            margin-bottom: 8px;
            color: var(--primary-color);
            font-weight: 500;
        }

        .form-group input,
        .form-group select,
        .form-group textarea,
        .form-control {
            width: 100%;
            padding: 12px;
            border: 2px solid rgba(246, 152, 152, 0.3);
            border-radius: 10px;
            font-size: 1em;
            transition: all 0.3s ease;
            background: rgba(255, 255, 255, 0.1);
            color: white;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus,
        .form-control:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(246, 152, 152, 0.1);
        }

        .search-filters {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 25px;
            padding: 20px;
            background: rgba(246, 152, 152, 0.05);
            border-radius: 10px;
            border: 1px solid rgba(246, 152, 152, 0.2);
        }

        .filter-group {
            display: flex;
            flex-direction: column;
        }

        .filter-label {
            color: var(--primary-color);
            margin-bottom: 5px;
            font-weight: bold;
            font-size: 0.9rem;
        }

        .filter-control {
            padding: 10px;
            border: 1px solid rgba(246, 152, 152, 0.3);
            border-radius: 6px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 0.9rem;
        }

        .filter-control:focus {
            border-color: var(--primary-color);
            outline: none;
        }

        .subscribers-table {
            width: 100%;
            background: var(--darker-bg);
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(246, 152, 152, 0.2);
        }

        .table-header {
            background: linear-gradient(135deg, var(--primary-color), var(--primary-light));
            color: white;
            font-weight: bold;
        }

        .table-header, .table-row {
            display: grid;
            grid-template-columns: 1fr 1fr 2fr 2fr 1fr 1fr;
            padding: 15px;
            align-items: center;
            gap: 10px;
        }

        .table-row {
            border-bottom: 1px solid rgba(246, 152, 152, 0.1);
            transition: var(--transition);
        }

        .table-row:hover {
            background: rgba(246, 152, 152, 0.1);
        }

        .table-row:last-child {
            border-bottom: none;
        }

        .subscriber-name {
            font-weight: bold;
            color: var(--primary-color);
        }

        .subscriber-phone {
            font-family: monospace;
            background: rgba(246, 152, 152, 0.1);
            padding: 5px 8px;
            border-radius: 4px;
            font-size: 0.9rem;
        }

        .tags {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
        }

        .tag {
            background: rgba(37, 211, 102, 0.2);
            color: var(--whatsapp-color);
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 0.8rem;
            border: 1px solid rgba(37, 211, 102, 0.3);
        }

        .tag.area {
            background: rgba(246, 152, 152, 0.2);
            color: var(--primary-color);
            border-color: rgba(246, 152, 152, 0.3);
        }

        .date-text {
            font-size: 0.9rem;
            color: var(--text-muted);
        }

        .action-buttons-row {
            display: flex;
            gap: 8px;
        }

        .btn-small {
            padding: 6px 10px;
            font-size: 0.8rem;
            min-width: auto;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            backdrop-filter: blur(5px);
        }

        .modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: var(--darker-bg);
            padding: 30px;
            border-radius: 15px;
            width: 90%;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
            border: 2px solid var(--primary-color);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            border-bottom: 2px solid var(--primary-color);
            padding-bottom: 15px;
        }

        .modal-title {
            color: var(--primary-color);
            font-size: 1.5rem;
            font-weight: bold;
        }

        .close {
            color: var(--text-muted);
            font-size: 2rem;
            cursor: pointer;
            transition: var(--transition);
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
        }

        .close:hover {
            color: white;
            background: rgba(246, 152, 152, 0.1);
        }

        .alert {
            padding: 15px 20px;
            border-radius: 8px;
            margin: 20px 0;
            display: none;
        }

        .alert-success {
            background: linear-gradient(135deg, #28a745, #20c997);
            color: white;
        }

        .alert-error {
            background: linear-gradient(135deg, #dc3545, #e74c3c);
            color: white;
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: var(--text-muted);
        }

        .empty-state i {
            font-size: 4rem;
            margin-bottom: 20px;
            opacity: 0.5;
            color: var(--primary-color);
        }

        .connection-status {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px 15px;
            background: rgba(246, 152, 152, 0.1);
            border-radius: 25px;
            margin-bottom: 15px;
            border: 1px solid rgba(246, 152, 152, 0.3);
        }

        .status-indicator {
            display: inline-block;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            margin-left: 10px;
        }

        .status-online {
            background: #2ed573;
        }

        .status-offline {
            background: #ff4757;
        }

        .status-loading {
            background: #ffa502;
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }

        .whatsapp-message {
            background: #dcf8c6;
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            font-family: system-ui;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            color: #333;
        }

        .loading {
            text-align: center;
            padding: 20px;
            color: #666;
        }

        .error {
            background: #ff4757;
            color: white;
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
        }

        .success {
            background: #2ed573;
            color: white;
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
        }

        .preview-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            backdrop-filter: blur(5px);
        }

        .preview-content {
            background: var(--darker-bg);
            padding: 30px;
            border-radius: 20px;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
            border: 2px solid var(--primary-color);
        }

        .close-btn {
            background: var(--primary-color);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            float: right;
            margin-top: 15px;
        }

        @media (max-width: 768px) {
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .action-buttons {
                flex-direction: column;
            }
            
            .search-filters {
                grid-template-columns: 1fr;
            }
            
            .table-header, .table-row {
                grid-template-columns: 1fr;
                gap: 5px;
                padding: 10px;
            }
            
            .table-header {
                display: none;
            }
            
            .table-row {
                background: var(--dark-bg);
                margin-bottom: 10px;
                border-radius: 8px;
                border: none;
            }
            
            .table-row > div {
                padding: 5px 0;
            }
            
            .table-row > div:before {
                content: attr(data-label) ': ';
                font-weight: bold;
                color: var(--primary-color);
                margin-left: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- ×›×•×ª×¨×ª -->
        <div class="header">
            <h1><i class="fas fa-users-cog"></i> × ×™×”×•×œ ×× ×•×™×™ ×”×ª×¨××•×ª WhatsApp</h1>
            <p>××¢×¨×›×ª × ×™×”×•×œ ××ª×§×“××ª ×œ×× ×•×™×™ ×”×ª×¨××•×ª ××©×¨×•×ª - ××” ×™×© ×¤×”?</p>
        </div>

        <!-- ×¡×˜×˜×™×¡×˜×™×§×•×ª -->
        <div class="stats-grid">
            <div class="stat-card">
                <span class="stat-number" id="totalSubscribers">0</span>
                <div class="stat-label">×× ×•×™×™× ×¤×¢×™×œ×™×</div>
            </div>
            <div class="stat-card">
                <span class="stat-number" id="totalAlerts">0</span>
                <div class="stat-label">×”×ª×¨××•×ª × ×©×œ×—×•</div>
            </div>
            <div class="stat-card">
                <span class="stat-number" id="newThisWeek">0</span>
                <div class="stat-label">×× ×•×™×™× ×”×©×‘×•×¢</div>
            </div>
            <div class="stat-card">
                <span class="stat-number" id="categoriesCount">0</span>
                <div class="stat-label">×§×˜×’×•×¨×™×•×ª ×¤×¢×™×œ×•×ª</div>
            </div>
        </div>

        <!-- ×›×œ×™ × ×™×”×•×œ -->
        <div class="admin-section">
            <div class="section-header">
                <h2 class="section-title"><i class="fas fa-tools"></i> ×›×œ×™ × ×™×”×•×œ</h2>
                <div class="connection-status">
                    <span>×¡×˜×˜×•×¡ ××¢×¨×›×ª:</span>
                    <div id="system-status" class="status-indicator status-loading"></div>
                    <span id="status-text">××ª×—×‘×¨...</span>
                </div>
            </div>
            
            <div class="action-buttons">
                <button class="btn" onclick="exportSubscribers()">
                    <i class="fas fa-download"></i> ×™×™×¦× ×× ×•×™×™×
                </button>
                <label for="import-file" class="btn">
                    <i class="fas fa-upload"></i> ×™×™×‘× ×× ×•×™×™×
                </label>
                <input type="file" id="import-file" style="display: none;" accept=".json" onchange="importSubscribers(event)">
                <button class="btn btn-secondary" onclick="clearAllData()">
                    <i class="fas fa-trash"></i> × ×§×” ×”×›×œ
                </button>
                <button class="btn" onclick="generateReport()">
                    <i class="fas fa-chart-bar"></i> ×“×•×— ××¤×•×¨×˜
                </button>
                <button class="btn btn-secondary" onclick="refreshSubscribersList()">
                    <i class="fas fa-sync"></i> ×¨×¢× ×Ÿ ×¨×©×™××”
                </button>
                <button class="btn" onclick="addTestSubscribers()">
                    <i class="fas fa-users-plus"></i> ×”×•×¡×£ ×× ×•×™×™× ×œ×‘×“×™×§×”
                </button>
            </div>
        </div>

        <!-- ×©×œ×™×—×” ×××•×§×“×ª ×œ×¤×™ ××¡×¤×¨ ××©×¨×” -->
        <div class="admin-section">
            <div class="section-header">
                <h2 class="section-title"><i class="fas fa-search-plus"></i> ×©×œ×™×—×” ×××•×§×“×ª ×œ×¤×™ ××¡×¤×¨ ××©×¨×”</h2>
            </div>
            
            <div class="form-group">
                <label for="jobSearchInput">××¡×¤×¨ ××©×¨×” (×œ××©×œ: A-25821)</label>
                <div style="display: flex; gap: 10px;">
                    <input type="text" id="jobSearchInput" placeholder="×”×›× ×¡ ××¡×¤×¨ ××©×¨×” ×œ×—×™×¤×•×©..." style="flex: 1;">
                    <button class="btn" onclick="searchJobAndSend()">
                        <i class="fas fa-search"></i> ×—×¤×© ×•×©×œ×—
                    </button>
                </div>
            </div>

            <div class="form-group">
                <label>××• ×”×›× ×¡ ×¤×¨×˜×™ ××©×¨×” ×™×“× ×™×ª:</label>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 15px;">
                    <input type="text" id="manualJobTitle" placeholder="×›×•×ª×¨×ª ×”××©×¨×”">
                    <input type="text" id="manualCompany" placeholder="×©× ×”×—×‘×¨×”">
                    <select id="manualArea">
                        <option value="">×‘×—×¨ ××–×•×¨</option>
                        <option value="××¨×›×–">××¨×›×–</option>
                        <option value="×¦×¤×•×Ÿ">×¦×¤×•×Ÿ</option>
                        <option value="×“×¨×•×">×“×¨×•×</option>
                        <option value="×™×¨×•×©×œ×™× ×•×”×¡×‘×™×‘×”">×™×¨×•×©×œ×™× ×•×”×¡×‘×™×‘×”</option>
                        <option value="×›×œ ×”××¨×¥">×›×œ ×”××¨×¥</option>
                    </select>
                    <select id="manualCategory">
                        <option value="">×‘×—×¨ ×§×˜×’×•×¨×™×”</option>
                        <option value="×œ×•×’×™×¡×˜×™×§×”, ××—×¡× ×™×, ×©×™×œ×•×— ×•×¨×›×©">×œ×•×’×™×¡×˜×™×§×”, ××—×¡× ×™×, ×©×™×œ×•×— ×•×¨×›×©</option>
                        <option value="×¤×™×ª×•×— ×•×ª×•×›× ×”">×¤×™×ª×•×— ×•×ª×•×›× ×”</option>
                        <option value="××›×™×¨×•×ª ×•×©×™×•×•×§">××›×™×¨×•×ª ×•×©×™×•×•×§</option>
                        <option value="×—×™× ×•×š ×•×”×•×¨××”">×—×™× ×•×š ×•×”×•×¨××”</option>
                        <option value="××–×•×Ÿ ×•××¡×¢×“× ×•×ª">××–×•×Ÿ ×•××¡×¢×“× ×•×ª</option>
                    </select>
                </div>
                <button class="btn btn-secondary" onclick="sendManualJob()">
                    <i class="fas fa-paper-plane"></i> ×©×œ×— ××©×¨×” ×™×“× ×™×ª
                </button>
            </div>

            <div id="jobSearchResults" style="margin-top: 20px;"></div>
        </div>

        <!-- ×©×œ×™×—×” ×™×©×™×¨×” ×œ×× ×•×™ ×¡×¤×¦×™×¤×™ -->
        <div class="admin-section">
            <div class="section-header">
                <h2 class="section-title"><i class="fas fa-user-plus"></i> ×©×œ×™×—×” ×™×©×™×¨×” ×œ×× ×•×™ ×¡×¤×¦×™×¤×™</h2>
            </div>
            
            <div class="form-group">
                <label for="subscriberSelect">×‘×—×¨ ×× ×•×™:</label>
                <select id="subscriberSelect">
                    <option value="">×‘×—×¨ ×× ×•×™ ××”×¨×©×™××”...</option>
                </select>
            </div>

            <div class="form-group">
                <label for="directMessage">×”×•×“×¢×” ××•×ª×××ª ××™×©×™×ª:</label>
                <textarea id="directMessage" rows="4" placeholder="×›×ª×•×‘ ×”×•×“×¢×” ××•×ª×××ª ××™×©×™×ª ×œ×× ×•×™..."></textarea>
            </div>

            <div class="action-buttons">
                <button class="btn" onclick="previewDirectMessage()">
                    <i class="fas fa-eye"></i> ×ª×¦×•×’×” ××§×“×™××”
                </button>
                <button class="btn btn-secondary" onclick="sendDirectMessage()">
                    <i class="fas fa-paper-plane"></i> ×©×œ×— ×”×•×“×¢×”
                </button>
            </div>
        </div>

        <!-- × ×™×”×•×œ ××©×¨×•×ª ××’×™×˜ -->
        <div class="admin-section">
            <div class="section-header">
                <h2 class="section-title">
                    <i class="fab fa-git-alt"></i> × ×™×”×•×œ ××©×¨×•×ª ××’×™×˜
                </h2>
                <div style="font-size: 0.9em; color: #999; margin-top: 5px;">
                    <i class="fas fa-database"></i> ××§×•×¨: data/jobs.json
                </div>
            </div>
            
            <div class="action-buttons">
                <button class="btn btn-secondary" onclick="refreshJobsFromGit()">
                    <i class="fas fa-sync-alt"></i> ×¨×¢× ×Ÿ ××’×™×˜
                </button>
                <button class="btn" onclick="checkGitConnection()">
                    <i class="fas fa-wifi"></i> ×‘×“×•×§ ×—×™×‘×•×¨
                </button>
                <button class="btn btn-secondary" onclick="showJobsStats()">
                    <i class="fas fa-chart-pie"></i> ×¡×˜×˜×™×¡×˜×™×§×•×ª ××©×¨×•×ª
                </button>
                <button class="btn" onclick="showRecentJobs()">
                    <i class="fas fa-clock"></i> ××©×¨×•×ª ×—×“×©×•×ª ×”×©×‘×•×¢
                </button>
            </div>

            <!-- ××—×•×•×Ÿ ×¡×˜×˜×•×¡ ×—×™×‘×•×¨ -->
            <div id="git-connection-status" class="connection-status" style="margin-top: 15px;">
                <i class="fab fa-git-alt"></i>
                <span>×—×™×‘×•×¨ ×œ×’×™×˜:</span>
                <div id="git-status-indicator" class="status-indicator status-loading"></div>
                <span id="git-status-text">×‘×•×“×§ ×—×™×‘×•×¨...</span>
                <button class="btn" onclick="testGitConnection()" style="margin-right: auto; padding: 5px 10px; font-size: 0.8em;">
                    <i class="fas fa-vial"></i> ×‘×“×™×§×” ××”×™×¨×”
                </button>
            </div>

            <!-- ×¡×˜×˜×™×¡×˜×™×§×•×ª ××©×¨×•×ª -->
            <div id="jobs-stats" style="margin-top: 15px; padding: 15px; background: rgba(246,152,152,0.05); border-radius: 8px; display: none;">
                <h4 style="color: var(--primary-color); margin-bottom: 10px;">
                    <i class="fas fa-chart-bar"></i> ×¡×˜×˜×™×¡×˜×™×§×•×ª ××©×¨×•×ª
                </h4>
                <div id="jobs-stats-content">×˜×•×¢×Ÿ...</div>
            </div>

            <!-- ×›×œ×™ ×‘×“×™×§×” ×•×¤×™×ª×•×— -->
            <div style="margin-top: 20px; padding: 15px; background: rgba(37, 211, 102, 0.1); border-radius: 8px;">
                <h5 style="color: #25D366; margin-bottom: 15px;">
                    <i class="fas fa-flask"></i> ×›×œ×™ ×‘×“×™×§×” ×•×¤×™×ª×•×—
                </h5>
                
                <div class="action-buttons">
                    <button class="btn" onclick="analyzeCorrectJobsStructure()">
                        <i class="fas fa-microscope"></i> × ×ª×— ××‘× ×” ××©×¨×•×ª
                    </button>
                    <button class="btn btn-secondary" onclick="testJobSearchDemo()">
                        <i class="fas fa-search"></i> ×‘×“×•×§ ×—×™×¤×•×©
                    </button>
                    <button class="btn" onclick="showJobFormats()">
                        <i class="fas fa-list"></i> ×”×¦×’ ×¤×•×¨××˜×™×
                    </button>
                    <button class="btn btn-secondary" onclick="testMatchingDemo()">
                        <i class="fas fa-users"></i> ×‘×“×•×§ ×”×ª×××ª ×× ×•×™×™×
                    </button>
                    <button class="btn" onclick="testCategoryMatching()">
                        <i class="fas fa-vial"></i> ×‘×“×•×§ ×§×˜×’×•×¨×™×•×ª
                    </button>
                </div>
            </div>
        </div>

        <!-- ×¡×§×¦×™×™×ª ××©×¨×•×ª ×—×“×©×•×ª -->
        <div id="recent-jobs-section" class="admin-section" style="display: none;">
            <div class="section-header">
                <h2 class="section-title">
                    <i class="fas fa-clock"></i> ××©×¨×•×ª ×—×“×©×•×ª ×”×©×‘×•×¢
                </h2>
            </div>
            <div id="recent-jobs-content"></div>
        </div>

        <!-- ×—×™×¤×•×© ×•×¡×™× ×•×Ÿ -->
        <div class="section">
            <h2><i class="fas fa-search"></i> ×¨×©×™××ª ×× ×•×™×™×</h2>
            
            <div class="search-filters">
                <div class="filter-group">
                    <label class="filter-label">×—×™×¤×•×©:</label>
                    <input type="text" class="filter-control" id="searchInput" placeholder="×—×¤×© ×œ×¤×™ ×©× ××• ×˜×œ×¤×•×Ÿ...">
                </div>
                <div class="filter-group">
                    <label class="filter-label">×§×˜×’×•×¨×™×”:</label>
                    <select class="filter-control" id="filterCategory">
                        <option value="">×›×œ ×”×§×˜×’×•×¨×™×•×ª</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label class="filter-label">××–×•×¨:</label>
                    <select class="filter-control" id="filterArea">
                        <option value="">×›×œ ×”××–×•×¨×™×</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label class="filter-label">×ª××¨×™×š ×”×¨×©××”:</label>
                    <select class="filter-control" id="filterDate">
                        <option value="">×›×œ ×”×ª××¨×™×›×™×</option>
                        <option value="today">×”×™×•×</option>
                        <option value="week">×”×©×‘×•×¢</option>
                        <option value="month">×”×—×•×“×©</option>
                    </select>
                </div>
            </div>

            <div id="subscribersCount" class="connection-status" style="margin-bottom: 20px;">
                <i class="fas fa-users"></i>
                <span>×¡×”"×› ×× ×•×™×™×: <strong id="totalCount">0</strong></span>
                <span>××•×¦×’×™×: <strong id="visibleCount">0</strong></span>
            </div>

            <div id="subscribersList"></div>
        </div>

        <!-- ×¡×˜×˜×™×¡×˜×™×§×•×ª -->
        <div class="section">
            <h2><i class="fas fa-chart-bar"></i> ×¡×˜×˜×™×¡×˜×™×§×•×ª</h2>
            <div id="statsContainer" class="stats-grid">
                <!-- ×¡×˜×˜×™×¡×˜×™×§×•×ª ×™×•×¦×’×• ×›××Ÿ -->
            </div>
        </div>
    </div>

    <script>
        // ××¢×¨×›×ª ×©××™×¨×” ×‘×§×‘×¦×™ JSON
        class JSONDataManager {
            constructor() {
                this.subscribersFile = 'data/subscribers.json';
                this.jobsFile = 'data/jobs.json';
                this.useLocalBackup = true;
            }

            // ×©××™×¨×ª ×× ×•×™×™×
            async saveSubscribers(subscribers) {
                try {
                    // × ×™×¡×™×•×Ÿ ×©××™×¨×” ×‘×©×¨×ª (×× ×™×© API)
                    const response = await fetch('/api/save-subscribers', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ subscribers })
                    });

                    if (response.ok) {
                        console.log('âœ… ×× ×•×™×™× × ×©××¨×• ×‘×©×¨×ª ×‘×”×¦×œ×—×”');
                        
                        // ×’×™×‘×•×™ ××§×•××™
                        if (this.useLocalBackup) {
                            localStorage.setItem('subscribers_backup', JSON.stringify(subscribers));
                        }
                        return true;
                    } else {
                        throw new Error('×©×’×™××” ×‘×©××™×¨×” ×‘×©×¨×ª');
                    }
                } catch (error) {
                    console.warn('âš ï¸ ×©×’×™××” ×‘×©××™×¨×” ×‘×©×¨×ª, ×©×•××¨ ××§×•××™×ª:', error);
                    
                    // ×©××™×¨×” ××§×•××™×ª ×‘××§×¨×” ×©×œ ×©×’×™××”
                    localStorage.setItem('whatsapp_alerts_subscribers', JSON.stringify(subscribers));
                    return false;
                }
            }

            // ×˜×¢×™× ×ª ×× ×•×™×™×
            async loadSubscribers() {
                try {
                    // × ×¡×™×•×Ÿ ×˜×¢×™× ×” ××”×©×¨×ª
                    const response = await fetch('/api/get-subscribers');
                    
                    if (response.ok) {
                        const data = await response.json();
                        console.log('âœ… ×× ×•×™×™× × ×˜×¢× ×• ××”×©×¨×ª');
                        return data.subscribers || [];
                    } else {
                        throw new Error('×©×’×™××” ×‘×˜×¢×™× ×” ××”×©×¨×ª');
                    }
                } catch (error) {
                    console.warn('âš ï¸ ×©×’×™××” ×‘×˜×¢×™× ×” ××”×©×¨×ª, ×˜×•×¢×Ÿ ××§×•××™×ª:', error);
                    
                    // ×˜×¢×™× ×” ××§×•××™×ª
                    const localData = localStorage.getItem('whatsapp_alerts_subscribers');
                    const backupData = localStorage.getItem('subscribers_backup');
                    
                    if (localData) {
                        return JSON.parse(localData);
                    } else if (backupData) {
                        return JSON.parse(backupData);
                    } else {
                        return [];
                    }
                }
            }

            // ×˜×¢×™× ×ª ××©×¨×•×ª ××’×™×˜
            async loadJobs() {
                try {
                    const response = await fetch(this.jobsFile);
                    
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    
                    const jobs = await response.json();
                    console.log(`âœ… × ×˜×¢× ×• ${jobs.length} ××©×¨×•×ª ×-${this.jobsFile}`);
                    
                    // ×©××™×¨×” ×‘×’×™×‘×•×™ ××§×•××™
                    localStorage.setItem('jobs_backup', JSON.stringify(jobs));
                    
                    return jobs;
                } catch (error) {
                    console.warn('âš ï¸ ×©×’×™××” ×‘×˜×¢×™× ×ª ××©×¨×•×ª ××’×™×˜:', error);
                    
                    // ×˜×¢×™× ×” ××’×™×‘×•×™ ××§×•××™
                    const backupJobs = localStorage.getItem('jobs_backup');
                    if (backupJobs) {
                        console.log('ğŸ”„ ×˜×•×¢×Ÿ ××©×¨×•×ª ××’×™×‘×•×™ ××§×•××™');
                        return JSON.parse(backupJobs);
                    }
                    
                    return [];
                }
            }

            // ×‘×“×™×§×ª ×—×™×‘×•×¨ ×œ×©×¨×ª
            async testConnection() {
                try {
                    const response = await fetch('/api/health');
                    return response.ok;
                } catch (error) {
                    return false;
                }
            }
        }

        // ×× ×”×œ ××©×¨×•×ª ××•×ª×× ×œ×¤×•×¨××˜ ×”× ×›×•×Ÿ
        class CorrectJobsManager {
            constructor() {
                this.dataManager = new JSONDataManager();
                this.jobs = [];
                this.lastUpdate = null;
                this.loadJobs();
            }

            async loadJobs() {
                try {
                    this.jobs = await this.dataManager.loadJobs();
                    this.lastUpdate = new Date();
                    console.log(`âœ… × ×˜×¢× ×• ${this.jobs.length} ××©×¨×•×ª ×‘×¤×•×¨××˜ ×”× ×›×•×Ÿ`);
                } catch (error) {
                    console.error('âŒ ×©×’×™××” ×‘×˜×¢×™× ×ª ××©×¨×•×ª:', error);
                }
            }

            // ×—×™×¤×•×© ××©×¨×” ×œ×¤×™ ××¡×¤×¨ (×ª×•×× ×œ×¤×•×¨××˜ ×”×—×“×©)
            findJobById(jobId) {
                if (!jobId || !this.jobs) return null;

                // × ×™×§×•×™ ××¡×¤×¨ ×”××©×¨×”
                const cleanJobId = jobId.toString().trim();
                
                // ×—×™×¤×•×© ×‘××¡×¤×¨ ×”×©×“×•×ª ×”×¨×œ×•×•× ×˜×™×™×
                const job = this.jobs.find(job => {
                    if (!job) return false;
                    
                    // ×—×™×¤×•×© ×œ×¤×™ jobNumber (×”×©×“×” ×”× ×›×•×Ÿ!)
                    if (job.jobNumber && job.jobNumber.toString().trim() === cleanJobId) {
                        return true;
                    }
                    
                    // ×—×™×¤×•×© ×œ×¤×™ id ×›×’×™×‘×•×™
                    if (job.id && job.id.toString().trim() === cleanJobId) {
                        return true;
                    }
                    
                    // ×—×™×¤×•×© ×—×œ×§×™ ×‘×›×•×ª×¨×ª ××• ×—×‘×¨×”
                    if (cleanJobId.length > 3) {
                        if (job.title && job.title.includes(cleanJobId)) return true;
                        if (job.company && job.company.includes(cleanJobId)) return true;
                    }
                    
                    return false;
                });

                if (job) {
                    console.log(`âœ… × ××¦××” ××©×¨×”: ${job.jobNumber} - ${job.title}`);
                } else {
                    console.log(`âŒ ×œ× × ××¦××” ××©×¨×” ×¢× ×”××¡×¤×¨: ${cleanJobId}`);
                }

                return job;
            }

            // ×”××¨×ª ××©×¨×” ×œ×¤×•×¨××˜ ×ª×§× ×™
            normalizeJob(job) {
                if (!job) return null;

                return {
                    id: job.jobNumber || job.id || 'unknown',
                    jobNumber: job.jobNumber || job.id || 'unknown', 
                    title: job.title || '×œ×œ× ×›×•×ª×¨×ª',
                    company: job.company || '×œ× ×¦×•×™×Ÿ',
                    area: job.region || job.area || '×œ× ×¦×•×™×Ÿ',        // ×©×™××•×© ×‘-region!
                    region: job.region || job.area || '×œ× ×¦×•×™×Ÿ',      // ×’× ×©×“×” × ×¤×¨×“
                    city: job.city || '×œ× ×¦×•×™×Ÿ',
                    category: job.category || '××—×¨',
                    description: job.description || '',
                    requirements: job.requirements || '',
                    salary: job.salary || '×œ×¤×™ × ×™×¡×™×•×Ÿ',
                    status: job.status || 'unknown',
                    featured: job.featured || false,
                    createdAt: job.createdAt || new Date().toISOString()
                };
            }

            // ××¦×™××ª ×× ×•×™×™× ××ª××™××™×
            findMatchingSubscribers(job, subscribers) {
                if (!job || !subscribers) return [];

                return subscribers.filter(subscriber => {
                    // ×”×ª×××ª ×§×˜×’×•×¨×™×” ××©×•×¤×¨×ª
                    const categoryMatch = this.matchCategory(job.category, subscriber.categories);
                    
                    // ×”×ª×××ª ××–×•×¨ (×©×™××•×© ×‘-region!)
                    const areaMatch = this.matchArea(job.region || job.area, subscriber.areas);
                    
                    return categoryMatch && areaMatch;
                });
            }

            // ×”×ª×××ª ×§×˜×’×•×¨×™×” ××©×•×¤×¨×ª
            matchCategory(jobCategory, subscriberCategories) {
                if (!jobCategory || !subscriberCategories) return false;
                
                const jobCat = jobCategory.toLowerCase();
                
                return subscriberCategories.some(subCat => {
                    const subCatLower = subCat.toLowerCase();
                    
                    // ×”×ª×××” ××“×•×™×§×ª
                    if (jobCat === subCatLower) return true;
                    
                    // ×”×ª×××” ×—×œ×§×™×ª
                    if (jobCat.includes(subCatLower) || subCatLower.includes(jobCat)) return true;
                    
                    // ×”×ª×××” ×œ×¤×™ ××™×œ×•×ª ××¤×ª×—
                    return this.matchByKeywords(jobCat, subCatLower);
                });
            }

            // ×”×ª×××ª ××™×œ×•×ª ××¤×ª×—
            matchByKeywords(jobCategory, subscriberCategory) {
                const keywordMap = {
                    '×œ×•×’×™×¡×˜×™×§×”': ['× ×”×’', '× ×”×™×’×”', '××©××™×ª', '×× ×•×£', '×”×•×‘×œ×”', '××—×¡×Ÿ', '×©×™×œ×•×—'],
                    '× ×”×™×’×”': ['×œ×•×’×™×¡×˜×™×§×”', '××©××™×ª', '×× ×•×£', '×”×•×‘×œ×”', '×ª×—×‘×•×¨×”'],
                    '×¤×™×ª×•×—': ['××¤×ª×—', '×ª×›× ×•×ª', '×ª×•×›× ×”', 'programmer', 'developer'],
                    '××›×™×¨×•×ª': ['×©×™×•×•×§', 'marketing', 'sales', '××•×›×¨'],
                    '×—×™× ×•×š': ['××•×¨×”', '×”×•×¨××”', '××—× ×š', '×’× × ×ª']
                };

                for (const [key, keywords] of Object.entries(keywordMap)) {
                    if (jobCategory.includes(key) && keywords.some(k => subscriberCategory.includes(k))) {
                        return true;
                    }
                    if (subscriberCategory.includes(key) && keywords.some(k => jobCategory.includes(k))) {
                        return true;
                    }
                }

                return false;
            }

            // ×”×ª×××ª ××–×•×¨
            matchArea(jobArea, subscriberAreas) {
                if (!jobArea || !subscriberAreas) return false;
                
                const jobAreaLower = jobArea.toLowerCase();
                
                return subscriberAreas.some(subArea => {
                    const subAreaLower = subArea.toLowerCase();
                    
                    return (
                        jobAreaLower === subAreaLower ||
                        jobAreaLower.includes(subAreaLower) ||
                        subAreaLower.includes(jobAreaLower) ||
                        subAreaLower === '×›×œ ×”××¨×¥' ||
                        subAreaLower === '××—×¨'
                    );
                });
            }

            // ×§×‘×œ×ª ×›×œ ×”××©×¨×•×ª
            getAllJobs() {
                return this.jobs || [];
            }

            // ×¡×˜×˜×™×¡×˜×™×§×•×ª ××©×¨×•×ª
            getJobsStats() {
                if (!this.jobs || this.jobs.length === 0) {
                    return { total: 0, categories: {}, regions: {}, status: {} };
                }

                const stats = {
                    total: this.jobs.length,
                    categories: {},
                    regions: {},
                    status: {},
                    lastUpdate: this.lastUpdate
                };

                this.jobs.forEach(job => {
                    // ×¡×˜×˜×™×¡×˜×™×§×•×ª ×§×˜×’×•×¨×™×•×ª
                    const category = job.category || '×œ× ×¦×•×™×Ÿ';
                    stats.categories[category] = (stats.categories[category] || 0) + 1;

                    // ×¡×˜×˜×™×¡×˜×™×§×•×ª ××–×•×¨×™×
                    const region = job.region || job.area || '×œ× ×¦×•×™×Ÿ';
                    stats.regions[region] = (stats.regions[region] || 0) + 1;

                    // ×¡×˜×˜×™×¡×˜×™×§×•×ª ×¡×˜×˜×•×¡
                    const status = job.status || '×œ× ×¦×•×™×Ÿ';
                    stats.status[status] = (stats.status[status] || 0) + 1;
                });

                return stats;
            }
        }

        // ×™×¦×™×¨×ª ×× ×”×œ ×”××©×¨×•×ª ×”×—×“×©
        const correctJobsManager = new CorrectJobsManager();
        const dataManager = new JSONDataManager();

        // ×¤×•× ×§×¦×™×•×ª ×¢×–×¨ ×’×œ×•×‘×œ×™×•×ª
        function searchJobById(jobId) {
            const job = correctJobsManager.findJobById(jobId);
            return job ? correctJobsManager.normalizeJob(job) : null;
        }

        // ×¢×“×›×•×Ÿ ×§×˜×’×•×¨×™×•×ª ×œ×”×ª××™× ×œ××¢×¨×›×ª ×”××©×¨×•×ª ×©×œ×š
        const updatedJobCategories = [
            '×œ×•×’×™×¡×˜×™×§×”, ××—×¡× ×™×, ×©×™×œ×•×— ×•×¨×›×©',
            '×¤×™×ª×•×— ×•×ª×•×›× ×”',
            '××›×™×¨×•×ª ×•×©×™×•×•×§', 
            '×—×™× ×•×š ×•×”×•×¨××”',
            '××–×•×Ÿ ×•××¡×¢×“× ×•×ª',
            '×‘×¨×™××•×ª ×•×¨×¤×•××”',
            '×‘× ×™×™×” ×•×”× ×“×¡×”',
            '×¢×™×¦×•×‘ ×•×™×¦×™×¨×”',
            '××‘×˜×—×” ×•×©××™×¨×”',
            '× ×™×”×•×œ ×•×›×¡×¤×™×',
            '×©×™×¨×•×ª ×œ×§×•×—×•×ª',
            '××©××‘×™ ×× ×•×©',
            '××“×¢ ×”× ×“×¡×” ××—×§×¨ ×•×¤×™×ª×•×—',
            '×¤×™× × ×¡×™× ×•×›×œ×›×œ×”',
            '×¡×—×¨ ×•×§××¢×•× ××•×ª',
            '×ª×™×™×¨×•×ª ×•×¤× ××™',
            '×ª×§×©×•×¨×ª ×•××“×™×',
            '×—×§×œ××•×ª ×•×¡×‘×™×‘×”',
            '×ª×—×‘×•×¨×” ×•× ×”×™×’×”',
            '××—×¨'
        ];

        const updatedJobAreas = [
            '××¨×›×–',
            '×¦×¤×•×Ÿ', 
            '×“×¨×•×',
            '×™×¨×•×©×œ×™× ×•×”×¡×‘×™×‘×”',
            '×—×™×¤×” ×§×¨×™×•×ª ×•×”×¦×¤×•×Ÿ',
            '×©×¨×•×Ÿ',
            '×©×¤×œ×”',
            '×’×œ×™×œ',
            '× ×’×‘',
            '×›×œ ×”××¨×¥',
            '×¢×‘×•×“×” ××”×‘×™×ª',
            '××—×¨'
        ];

        // ××¢×¨×›×ª × ×™×”×•×œ ×× ×•×™×™× ××¢×•×“×›× ×ª
        class AdminPanel {
            constructor() {
                this.whatsappAlerts = null;
                this.dataManager = new JSONDataManager();
                this.currentFilter = {
                    category: '',
                    area: '',
                    date: '',
                    search: ''
                };
                this.init();
            }

            async init() {
                // ×˜×¢×™× ×ª ×× ×•×™×™× ××”×©×¨×ª/×§×•×‘×¥
                await this.loadSubscribersFromServer();
                
                this.loadFilters();
                this.renderSubscribers();
                this.updateStats();
                this.attachEvents();
                this.updateSystemStatus();
                
                // ×˜×¢×™× ×ª ×¨×©×™××ª ×× ×•×™×™× ×œ×©×œ×™×—×” ×™×©×™×¨×”
                this.loadSubscriberSelect();
                
                // ×‘×“×™×§×ª ×—×™×‘×•×¨ ×’×™×˜
                this.checkGitConnection();
                
                console.log('ğŸ”§ ×¤×× ×œ × ×™×”×•×œ ×”×•×¤×¢×œ');
            }

            async loadSubscribersFromServer() {
                try {
                    const subscribers = await this.dataManager.loadSubscribers();
                    
                    // ×™×¦×™×¨×ª ××¢×¨×›×ª WhatsApp Alerts ×¢× ×”×× ×•×™×™× ×”×§×™×™××™×
                    this.whatsappAlerts = {
                        subscribers: subscribers,
                        options: {
                            categories: updatedJobCategories,
                            areas: updatedJobAreas
                        },
                        getSubscribers: () => this.whatsappAlerts.subscribers,
                        addSubscriber: (subscriber) => {
                            this.whatsappAlerts.subscribers.push(subscriber);
                            this.saveSubscribers();
                        },
                        removeSubscriber: (phone) => {
                            this.whatsappAlerts.subscribers = this.whatsappAlerts.subscribers.filter(s => s.phone !== phone);
                            this.saveSubscribers();
                        },
                        createJobMessage: (jobData) => {
                            return `ğŸ”¥ ××©×¨×” ×—×“×©×”!

ğŸ“‹ ${jobData.title}
ğŸ¢ ${jobData.company || '×œ× ×¦×•×™×Ÿ'}
ğŸ“ ${jobData.region || jobData.area}
ğŸ¯ ${jobData.category}

${jobData.description ? `ğŸ’¬ ${jobData.description}\n\n` : ''}×œ×¤×¨×˜×™× × ×•×¡×¤×™×: https://www.mayeshpo.co.il

×‘×”×¦×œ×—×”! ğŸ’ª`;
                        },
                        sendJobAlert: (jobData) => {
                            const matchingSubscribers = correctJobsManager.findMatchingSubscribers(jobData, this.whatsappAlerts.subscribers);
                            
                            if (matchingSubscribers.length === 0) {
                                console.log('âŒ ××™×Ÿ ×× ×•×™×™× ××ª××™××™×');
                                return false;
                            }

                            const message = this.whatsappAlerts.createJobMessage(jobData);
                            
                            matchingSubscribers.forEach(subscriber => {
                                const phoneNumber = subscriber.phone.replace(/^0/, '972').replace(/\D/g, '');
                                const whatsappUrl = `https://wa.me/${phoneNumber}?text=${encodeURIComponent(message)}`;
                                console.log(`ğŸ“± ×©×•×œ×— ×œ-${subscriber.phone}:`, whatsappUrl);
                            });
                            
                            return true;
                        }
                    };
                    
                    console.log(`âœ… × ×˜×¢× ×• ${subscribers.length} ×× ×•×™×™× ××”×©×¨×ª`);
                } catch (error) {
                    console.error('âŒ ×©×’×™××” ×‘×˜×¢×™× ×ª ×× ×•×™×™×:', error);
                    this.whatsappAlerts = {
                        subscribers: [],
                        options: {
                            categories: updatedJobCategories,
                            areas: updatedJobAreas
                        },
                        getSubscribers: () => [],
                        addSubscriber: () => {},
                        removeSubscriber: () => {},
                        createJobMessage: () => {},
                        sendJobAlert: () => false
                    };
                }
            }

            async saveSubscribers() {
                if (this.whatsappAlerts && this.whatsappAlerts.subscribers) {
                    await this.dataManager.saveSubscribers(this.whatsappAlerts.subscribers);
                }
            }

            async updateSystemStatus() {
                const statusIndicator = document.getElementById('system-status');
                const statusText = document.getElementById('status-text');
                
                try {
                    const isConnected = await this.dataManager.testConnection();
                    
                    if (isConnected) {
                        statusIndicator.className = 'status-indicator status-online';
                        statusText.textContent = '××—×•×‘×¨ ×œ×©×¨×ª';
                    } else {
                        statusIndicator.className = 'status-indicator status-offline';
                        statusText.textContent = '×¢×•×‘×“ ××§×•××™×ª';
                    }
                } catch (error) {
                    statusIndicator.className = 'status-indicator status-offline';
                    statusText.textContent = '×‘×¢×™×™×ª ×—×™×‘×•×¨';
                }
            }

            loadFilters() {
                const categoryFilter = document.getElementById('filterCategory');
                const areaFilter = document.getElementById('filterArea');
                
                // ×˜×¢×™× ×ª ×§×˜×’×•×¨×™×•×ª
                categoryFilter.innerHTML = '<option value="">×›×œ ×”×§×˜×’×•×¨×™×•×ª</option>';
                updatedJobCategories.forEach(category => {
                    const option = document.createElement('option');
                    option.value = category;
                    option.textContent = category;
                    categoryFilter.appendChild(option);
                });

                // ×˜×¢×™× ×ª ××–×•×¨×™×
                areaFilter.innerHTML = '<option value="">×›×œ ×”××–×•×¨×™×</option>';
                updatedJobAreas.forEach(area => {
                    const option = document.createElement('option');
                    option.value = area;
                    option.textContent = area;
                    areaFilter.appendChild(option);
                });
            }

            loadSubscriberSelect() {
                const select = document.getElementById('subscriberSelect');
                if (!select) return;
                
                const subscribers = this.whatsappAlerts ? this.whatsappAlerts.getSubscribers() : [];
                
                select.innerHTML = '<option value="">×‘×—×¨ ×× ×•×™ ××”×¨×©×™××”...</option>';
                
                if (subscribers.length === 0) {
                    select.innerHTML += '<option value="" disabled>××™×Ÿ ×× ×•×™×™× ×¢×“×™×™×Ÿ</option>';
                    return;
                }
                
                subscribers.forEach((subscriber, index) => {
                    const option = document.createElement('option');
                    option.value = index;
                    option.textContent = `${subscriber.phone} - ${subscriber.name || '×œ×œ× ×©×'}`;
                    select.appendChild(option);
                });
            }

            attachEvents() {
                // ×—×™×¤×•×© ×•×¡×™× ×•×Ÿ
                const searchInput = document.getElementById('searchInput');
                const filterCategory = document.getElementById('filterCategory');
                const filterArea = document.getElementById('filterArea');
                const filterDate = document.getElementById('filterDate');

                if (searchInput) searchInput.addEventListener('input', () => this.filterSubscribers());
                if (filterCategory) filterCategory.addEventListener('change', () => this.filterSubscribers());
                if (filterArea) filterArea.addEventListener('change', () => this.filterSubscribers());
                if (filterDate) filterDate.addEventListener('change', () => this.filterSubscribers());

                // ××§×œ×“×ª
                document.addEventListener('keydown', (e) => {
                    if (e.key === 'Escape') {
                        this.closeAllModals();
                    }
                });
            }

            renderSubscribers() {
                const subscribers = this.getFilteredSubscribers();
                const container = document.getElementById('subscribersList');
                
                if (!subscribers || subscribers.length === 0) {
                    container.innerHTML = `
                        <div style="text-align: center; padding: 40px; color: #666;">
                            <i class="fas fa-users" style="font-size: 3em; margin-bottom: 20px; opacity: 0.3; color: var(--primary-color);"></i>
                            <h3>××™×Ÿ ×× ×•×™×™× ×œ×”×¦×’×”</h3>
                            <p>×¢×“×™×™×Ÿ ×œ× × ×¨×©××• ×× ×•×™×™× ×‘××¢×¨×›×ª ××• ×©×”×¡×™× ×•×Ÿ ××¡×ª×™×¨ ××ª ×›×•×œ×</p>
                            <button class="btn" onclick="addTestSubscribers()" style="margin-top: 15px;">
                                <i class="fas fa-users-plus"></i> ×”×•×¡×£ ×× ×•×™×™× ×œ×‘×“×™×§×”
                            </button>
                        </div>
                    `;
                    
                    this.updateCounts(0, 0);
                    return;
                }

                const html = subscribers.map(subscriber => `
                    <div style="background: rgba(246, 152, 152, 0.1); border: 1px solid rgba(246, 152, 152, 0.3); border-radius: 8px; padding: 15px; margin-bottom: 10px;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                            <div>
                                <div style="font-weight: bold; color: var(--primary-color);">${subscriber.name || '×œ×œ× ×©×'}</div>
                                <div style="font-family: monospace; background: rgba(246, 152, 152, 0.2); padding: 2px 6px; border-radius: 4px; display: inline-block; margin-top: 5px;">${subscriber.phone}</div>
                            </div>
                            <div style="display: flex; gap: 5px;">
                                <button class="btn btn-small btn-secondary" onclick="contactSubscriber('${subscriber.phone}')" title="×©×œ×— ×”×•×“×¢×”">
                                    <i class="fab fa-whatsapp"></i>
                                </button>
                                <button class="btn btn-small btn-danger" onclick="removeSubscriber('${subscriber.phone}')" title="×”×¡×¨ ×× ×•×™">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </div>
                        
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 10px;">
                            <div>
                                <strong style="color: var(--primary-color);">×§×˜×’×•×¨×™×•×ª:</strong><br>
                                <div style="display: flex; flex-wrap: wrap; gap: 3px; margin-top: 3px;">
                                    ${subscriber.categories ? subscriber.categories.map(cat => `<span style="background: rgba(37, 211, 102, 0.2); color: #25D366; padding: 2px 6px; border-radius: 10px; font-size: 0.8em;">${cat}</span>`).join('') : '×œ× ×¦×•×™×Ÿ'}
                                </div>
                            </div>
                            <div>
                                <strong style="color: var(--primary-color);">××–×•×¨×™×:</strong><br>
                                <div style="display: flex; flex-wrap: wrap; gap: 3px; margin-top: 3px;">
                                    ${subscriber.areas ? subscriber.areas.map(area => `<span style="background: rgba(246, 152, 152, 0.2); color: var(--primary-color); padding: 2px 6px; border-radius: 10px; font-size: 0.8em;">${area}</span>`).join('') : '×œ× ×¦×•×™×Ÿ'}
                                </div>
                            </div>
                        </div>
                        
                        <div style="font-size: 0.9em; color: #999;">
                            ×ª××¨×™×š ×”×¨×©××”: ${subscriber.registrationDate ? new Date(subscriber.registrationDate).toLocaleDateString('he-IL') : '×œ× ×™×“×•×¢'}
                        </div>
                    </div>
                `).join('');

                container.innerHTML = html;
                
                // ×¢×“×›×•×Ÿ ××•× ×™×
                const totalSubscribers = this.whatsappAlerts ? this.whatsappAlerts.getSubscribers().length : 0;
                this.updateCounts(totalSubscribers, subscribers.length);
            }

            updateCounts(total, visible) {
                const totalCount = document.getElementById('totalCount');
                const visibleCount = document.getElementById('visibleCount');
                
                if (totalCount) totalCount.textContent = total;
                if (visibleCount) visibleCount.textContent = visible;
            }

            getFilteredSubscribers() {
                let subscribers = this.whatsappAlerts ? this.whatsappAlerts.getSubscribers() : [];
                
                // ×¡×™× ×•×Ÿ ×œ×¤×™ ×§×˜×’×•×¨×™×”
                const categoryFilter = document.getElementById('filterCategory');
                if (categoryFilter && categoryFilter.value) {
                    subscribers = subscribers.filter(sub => 
                        sub.categories && sub.categories.includes(categoryFilter.value)
                    );
                }

                // ×¡×™× ×•×Ÿ ×œ×¤×™ ××–×•×¨
                const areaFilter = document.getElementById('filterArea');
                if (areaFilter && areaFilter.value) {
                    subscribers = subscribers.filter(sub => 
                        sub.areas && sub.areas.includes(areaFilter.value)
                    );
                }

                // ×¡×™× ×•×Ÿ ×œ×¤×™ ×ª××¨×™×š
                const dateFilter = document.getElementById('filterDate');
                if (dateFilter && dateFilter.value) {
                    const now = new Date();
                    let filterDate;
                    
                    switch (dateFilter.value) {
                        case 'today':
                            filterDate = new Date(now.getFullYear(), now.getMonth(), now.getDate());
                            break;
                        case 'week':
                            filterDate = new Date(now.getTime() - 7 * 24 * 60 * 60 * 1000);
                            break;
                        case 'month':
                            filterDate = new Date(now.getFullYear(), now.getMonth(), 1);
                            break;
                    }
                    
                    if (filterDate) {
                        subscribers = subscribers.filter(sub => 
                            sub.registrationDate && new Date(sub.registrationDate) >= filterDate
                        );
                    }
                }

                // ×¡×™× ×•×Ÿ ×œ×¤×™ ×—×™×¤×•×© ×˜×§×¡×˜
                const searchInput = document.getElementById('searchInput');
                if (searchInput && searchInput.value) {
                    const searchTerm = searchInput.value.toLowerCase();
                    subscribers = subscribers.filter(sub => 
                        (sub.name && sub.name.toLowerCase().includes(searchTerm)) ||
                        (sub.phone && sub.phone.includes(searchTerm)) ||
                        (sub.categories && sub.categories.some(cat => cat.toLowerCase().includes(searchTerm))) ||
                        (sub.areas && sub.areas.some(area => area.toLowerCase().includes(searchTerm)))
                    );
                }

                return subscribers;
            }

            filterSubscribers() {
                this.renderSubscribers();
            }

            updateStats() {
                const subscribers = this.whatsappAlerts ? this.whatsappAlerts.getSubscribers() : [];
                const container = document.getElementById('statsContainer');
                
                if (subscribers.length === 0) {
                    container.innerHTML = `
                        <div class="stat-card">
                            <span class="stat-number">0</span>
                            <div class="stat-label">×¡×”"×› ×× ×•×™×™×</div>
                        </div>
                    `;
                    
                    // ×¢×“×›×•×Ÿ ×”×¡×˜×˜×™×¡×˜×™×§×•×ª ×”×¢×œ×™×•× ×•×ª
                    const totalSubscribersEl = document.getElementById('totalSubscribers');
                    const totalAlertsEl = document.getElementById('totalAlerts');
                    const newThisWeekEl = document.getElementById('newThisWeek');
                    const categoriesCountEl = document.getElementById('categoriesCount');
                    
                    if (totalSubscribersEl) totalSubscribersEl.textContent = '0';
                    if (totalAlertsEl) totalAlertsEl.textContent = '0';
                    if (newThisWeekEl) newThisWeekEl.textContent = '0';
                    if (categoriesCountEl) categoriesCountEl.textContent = '0';
                    
                    return;
                }

                // ×—×™×©×•×‘ ×¡×˜×˜×™×¡×˜×™×§×•×ª
                const stats = {
                    total: subscribers.length,
                    active: subscribers.filter(s => s.active !== false).length,
                    categories: {},
                    areas: {},
                    recent: 0
                };

                const oneWeekAgo = new Date(Date.now() - 7 * 24 * 60 * 60 * 1000);

                subscribers.forEach(subscriber => {
                    // ×§×˜×’×•×¨×™×•×ª ×¤×•×¤×•×œ×¨×™×•×ª
                    if (subscriber.categories) {
                        subscriber.categories.forEach(cat => {
                            stats.categories[cat] = (stats.categories[cat] || 0) + 1;
                        });
                    }
                    
                    // ××–×•×¨×™×
                    if (subscriber.areas) {
                        subscriber.areas.forEach(area => {
                            stats.areas[area] = (stats.areas[area] || 0) + 1;
                        });
                    }
                    
                    // ×× ×•×™×™× ×—×“×©×™× ×”×©×‘×•×¢
                    if (subscriber.registrationDate) {
                        const regDate = new Date(subscriber.registrationDate);
                        if (regDate >= oneWeekAgo) {
                            stats.recent++;
                        }
                    }
                });

                // ××¦×™××ª ×”×§×˜×’×•×¨×™×•×ª ×•×”××–×•×¨×™× ×”×¤×•×¤×•×œ×¨×™×™× ×‘×™×•×ª×¨
                const topCategories = Object.entries(stats.categories)
                    .sort((a, b) => b[1] - a[1])
                    .slice(0, 3);
                    
                const topAreas = Object.entries(stats.areas)
                    .sort((a, b) => b[1] - a[1])
                    .slice(0, 3);

                const html = `
                    <div class="stat-card">
                        <span class="stat-number">${stats.total}</span>
                        <div class="stat-label">×× ×•×™×™× ×¤×¢×™×œ×™×</div>
                    </div>
                    <div class="stat-card">
                        <span class="stat-number">${stats.active}</span>
                        <div class="stat-label">×× ×•×™×™× ×¨×©×•××™×</div>
                    </div>
                    <div class="stat-card">
                        <span class="stat-number">${stats.recent}</span>
                        <div class="stat-label">×× ×•×™×™× ×”×©×‘×•×¢</div>
                    </div>
                    <div class="stat-card">
                        <span class="stat-number">${Object.keys(stats.categories).length}</span>
                        <div class="stat-label">×§×˜×’×•×¨×™×•×ª ×¤×¢×™×œ×•×ª</div>
                    </div>
                    
                    ${topCategories.length > 0 ? `
                        <div style="grid-column: 1 / -1; margin-top: 20px;">
                            <h4 style="color: var(--primary-color); margin-bottom: 15px;">
                                <i class="fas fa-chart-bar"></i> ×§×˜×’×•×¨×™×•×ª ×¤×•×¤×•×œ×¨×™×•×ª
                            </h4>
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                                ${topCategories.map(([category, count]) => `
                                    <div style="background: rgba(246, 152, 152, 0.1); padding: 15px; border-radius: 8px; border: 1px solid rgba(246, 152, 152, 0.3);">
                                        <div style="font-weight: bold; color: var(--primary-color);">${category}</div>
                                        <div style="font-size: 1.5em; font-weight: bold; margin-top: 5px;">${count}</div>
                                        <div style="font-size: 0.9em; color: #666;">×× ×•×™×™×</div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    ` : ''}
                `;

                container.innerHTML = html;
                
                // ×¢×“×›×•×Ÿ ×”×¡×˜×˜×™×¡×˜×™×§×•×ª ×”×¢×œ×™×•× ×•×ª
                const totalSubscribersEl = document.getElementById('totalSubscribers');
                const totalAlertsEl = document.getElementById('totalAlerts');
                const newThisWeekEl = document.getElementById('newThisWeek');
                const categoriesCountEl = document.getElementById('categoriesCount');
                
                if (totalSubscribersEl) totalSubscribersEl.textContent = stats.total;
                if (totalAlertsEl) totalAlertsEl.textContent = localStorage.getItem('whatsapp_total_alerts') || '0';
                if (newThisWeekEl) newThisWeekEl.textContent = stats.recent;
                if (categoriesCountEl) categoriesCountEl.textContent = Object.keys(stats.categories).length;
            }

            async checkGitConnection() {
                const statusIndicator = document.getElementById('git-status-indicator');
                const statusText = document.getElementById('git-status-text');
                
                if (!statusIndicator || !statusText) return;
                
                statusIndicator.className = 'status-indicator status-loading';
                statusText.textContent = '×‘×•×“×§ ×—×™×‘×•×¨...';
                
                try {
                    const response = await fetch('data/jobs.json', { method: 'HEAD' });
                    
                    if (response.ok) {
                        statusIndicator.className = 'status-indicator status-online';
                        statusText.textContent = '××—×•×‘×¨ ×œ×’×™×˜';
                    } else {
                        throw new Error('×§×•×‘×¥ ×œ× × ××¦×');
                    }
                } catch (error) {
                    statusIndicator.className = 'status-indicator status-offline';
                    statusText.textContent = '××™×Ÿ ×—×™×‘×•×¨ ×œ×’×™×˜';
                }
            }

            // ×¤×•× ×§×¦×™×•×ª ×¢×–×¨
            showAlert(message, type = 'info') {
                console.log(`${type.toUpperCase()}: ${message}`);
                
                // ×™×¦×™×¨×ª ×”×ª×¨××” ×•×™×–×•××œ×™×ª
                const alert = document.createElement('div');
                alert.className = `alert alert-${type}`;
                alert.textContent = message;
                alert.style.display = 'block';
                alert.style.position = 'fixed';
                alert.style.top = '20px';
                alert.style.right = '20px';
                alert.style.zIndex = '9999';
                alert.style.maxWidth = '400px';
                
                document.body.appendChild(alert);
                
                setTimeout(() => {
                    alert.remove();
                }, 5000);
            }

            closeAllModals() {
                document.querySelectorAll('.modal, .preview-modal').forEach(modal => {
                    modal.remove();
                });
            }
        }

        // ×¤×•× ×§×¦×™×•×ª ×’×œ×•×‘×œ×™×•×ª ×œ×˜×™×¤×•×œ ×‘×× ×•×™×™×
        function addTestSubscribers() {
            if (!adminPanel || !adminPanel.whatsappAlerts) {
                alert('×”××¢×¨×›×ª ×œ× ××•×›× ×” ×¢×“×™×™×Ÿ');
                return;
            }

            const testSubscribers = [
                {
                    id: Date.now() + 1,
                    name: '×™×•×¡×™ ×›×”×Ÿ',
                    phone: '050-1234567',
                    categories: ['×¤×™×ª×•×— ×•×ª×•×›× ×”', '×˜×›× ×•×œ×•×’×™×”'],
                    areas: ['××¨×›×–', '×ª×œ ××‘×™×‘'],
                    registrationDate: new Date().toISOString(),
                    active: true
                },
                {
                    id: Date.now() + 2,
                    name: '×©×¨×” ×œ×•×™',
                    phone: '052-7654321',
                    categories: ['××›×™×¨×•×ª ×•×©×™×•×•×§', '×©×™×¨×•×ª ×œ×§×•×—×•×ª'],
                    areas: ['×¦×¤×•×Ÿ', '×—×™×¤×”'],
                    registrationDate: new Date(Date.now() - 2 * 24 * 60 * 60 * 1000).toISOString(),
                    active: true
                },
                {
                    id: Date.now() + 3,
                    name: '×“×•×“ ××‘×¨×”×',
                    phone: '054-9876543',
                    categories: ['×œ×•×’×™×¡×˜×™×§×”, ××—×¡× ×™×, ×©×™×œ×•×— ×•×¨×›×©', '× ×”×™×’×”'],
                    areas: ['×“×¨×•×', '×›×œ ×”××¨×¥'],
                    registrationDate: new Date(Date.now() - 5 * 24 * 60 * 60 * 1000).toISOString(),
                    active: true
                }
            ];

            testSubscribers.forEach(subscriber => {
                adminPanel.whatsappAlerts.addSubscriber(subscriber);
            });

            adminPanel.renderSubscribers();
            adminPanel.updateStats();
            adminPanel.loadSubscriberSelect();
            
            adminPanel.showAlert('× ×•×¡×¤×• 3 ×× ×•×™×™× ×œ×‘×“×™×§×”!', 'success');
        }

        function contactSubscriber(phone) {
            const message = '×©×œ×•×! ×× ×™ ×™×•×¦×¨/×ª ××™×ª×š ×§×©×¨ ×××¢×¨×›×ª ×”×ª×¨××•×ª ×”××©×¨×•×ª ×©×œ "××” ×™×© ×¤×”?". ××™×š ×× ×™ ×™×›×•×œ/×” ×œ×¢×–×•×¨?';
            const phoneNumber = phone.replace(/^0/, '972').replace(/\D/g, '');
            const whatsappUrl = `https://wa.me/${phoneNumber}?text=${encodeURIComponent(message)}`;
            window.open(whatsappUrl, '_blank');
        }

        function removeSubscriber(phone) {
            if (confirm(`×”×× ××ª×” ×‘×˜×•×— ×©×‘×¨×¦×•× ×š ×œ×”×¡×™×¨ ××ª ×”×× ×•×™ ${phone}?`)) {
                adminPanel.whatsappAlerts.removeSubscriber(phone);
                adminPanel.renderSubscribers();
                adminPanel.updateStats();
                adminPanel.loadSubscriberSelect();
                adminPanel.showAlert('×”×× ×•×™ ×”×•×¡×¨ ×‘×”×¦×œ×—×”', 'success');
            }
        }

        // ×¤×•× ×§×¦×™×•×ª ×œ××©×¨×•×ª
        function searchJobAndSend() {
            const jobNumber = document.getElementById('jobSearchInput').value.trim();
            const resultsDiv = document.getElementById('jobSearchResults');
            
            if (!jobNumber) {
                resultsDiv.innerHTML = '<div class="error">×× × ×”×›× ×¡ ××¡×¤×¨ ××©×¨×”</div>';
                return;
            }

            resultsDiv.innerHTML = '<div class="loading">××—×¤×© ××©×¨×”...</div>';

            // ×—×™×¤×•×© ×”××©×¨×”
            const job = correctJobsManager.findJobById(jobNumber);
            
            if (!job) {
                resultsDiv.innerHTML = `
                    <div class="error">
                        <i class="fas fa-exclamation-triangle"></i>
                        ×œ× × ××¦××” ××©×¨×” ×¢× ×”××¡×¤×¨: ${jobNumber}
                        <br><small>×‘×“×•×§ ×©×”××¡×¤×¨ × ×›×•×Ÿ ××• × ×¡×” ×—×™×¤×•×© ×—×œ×§×™</small>
                    </div>
                `;
                return;
            }

            // × ×¨××•×œ ×”××©×¨×”
            const normalizedJob = correctJobsManager.normalizeJob(job);

            // ×—×™×¤×•×© ×× ×•×™×™× ××ª××™××™×
            const subscribers = adminPanel?.whatsappAlerts?.getSubscribers() || [];
            const matchingSubscribers = correctJobsManager.findMatchingSubscribers(normalizedJob, subscribers);

            // ×”×¦×’×ª ×ª×•×¦××•×ª
            resultsDiv.innerHTML = `
                <div class="success">
                    <h4><i class="fas fa-briefcase"></i> × ××¦××” ××©×¨×”!</h4>
                    <div style="background: rgba(246, 152, 152, 0.1); padding: 15px; border-radius: 8px; margin: 10px 0; border: 1px solid rgba(246, 152, 152, 0.3);">
                        <strong>${normalizedJob.title}</strong><br>
                        <small>×—×‘×¨×”: ${normalizedJob.company}</small><br>
                        <small>××–×•×¨: ${normalizedJob.region}</small><br>
                        <small>×§×˜×’×•×¨×™×”: ${normalizedJob.category}</small>
                    </div>
                    <p><i class="fas fa-users"></i> × ××¦××• ${matchingSubscribers.length} ×× ×•×™×™× ××ª××™××™×</p>
                    ${matchingSubscribers.length > 0 ? 
                        `<button class="btn" onclick="sendToMatchingSubscribers('${normalizedJob.id}')">
                            <i class="fas fa-paper-plane"></i> ×©×œ×— ×œ-${matchingSubscribers.length} ×× ×•×™×™×
                        </button>` : 
                        '<p style="color: var(--primary-color);">××™×Ÿ ×× ×•×™×™× ××ª××™××™× ×œ×¤×™ ×”×§×˜×’×•×¨×™×” ×•×”××–×•×¨</p>'
                    }
                </div>
            `;
        }

        function sendToMatchingSubscribers(jobId) {
            const job = correctJobsManager.findJobById(jobId);
            if (!job) return;

            const normalizedJob = correctJobsManager.normalizeJob(job);
            const subscribers = adminPanel?.whatsappAlerts?.getSubscribers() || [];
            const matchingSubscribers = correctJobsManager.findMatchingSubscribers(normalizedJob, subscribers);

            if (matchingSubscribers.length === 0) {
                alert('××™×Ÿ ×× ×•×™×™× ××ª××™××™×');
                return;
            }

            // ×™×¦×™×¨×ª ×”×•×“×¢×”
            const message = `ğŸ”¥ ××©×¨×” ×—×“×©×”!

ğŸ“‹ ${normalizedJob.title}
ğŸ¢ ${normalizedJob.company}
ğŸ“ ${normalizedJob.region}
ğŸ¯ ${normalizedJob.category}

×œ×¤×¨×˜×™× × ×•×¡×¤×™×: https://www.mayeshpo.co.il

×‘×”×¦×œ×—×”! ğŸ’ª`;

            // ×”×¦×’×ª ×ª×¦×•×’×” ××§×“×™××”
            showPreview(message, matchingSubscribers, normalizedJob);
        }

        function showPreview(message, subscribers, job) {
            const modal = document.createElement('div');
            modal.className = 'preview-modal';
            modal.innerHTML = `
                <div class="preview-content">
                    <h3><i class="fas fa-eye"></i> ×ª×¦×•×’×” ××§×“×™××”</h3>
                    
                    <div style="margin: 15px 0;">
                        <strong>××©×¨×”:</strong> ${job.title}<br>
                        <strong>× ××¢× ×™×:</strong> ${subscribers.length} ×× ×•×™×™×
                    </div>
                    
                    <h4>×”×•×“×¢×” ×©×ª×™×©×œ×—:</h4>
                    <div class="whatsapp-message">
                        ${message.replace(/\n/g, '<br>')}
                    </div>
                    
                    <h4>×¨×©×™××ª × ××¢× ×™×:</h4>
                    <div style="max-height: 200px; overflow-y: auto; background: rgba(246, 152, 152, 0.1); padding: 10px; border-radius: 5px;">
                        ${subscribers.map(sub => 
                            `<div>ğŸ“± ${sub.phone} - ${sub.name || '×œ×œ× ×©×'}</div>`
                        ).join('')}
                    </div>
                    
                    <div style="margin-top: 15px;">
                        <button class="btn" onclick="confirmSendToAll('${job.id}')">
                            <i class="fas fa-paper-plane"></i> ×©×œ×— ×œ×›×œ ×”×× ×•×™×™× (${subscribers.length})
                        </button>
                        <button class="close-btn" onclick="this.parentElement.parentElement.parentElement.remove()">
                            <i class="fas fa-times"></i> ×¡×’×•×¨
                        </button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
        }

        function confirmSendToAll(jobId) {
            // ×¡×™××•×œ×¦×™×” ×©×œ ×©×œ×™×—×”
            console.log(`ğŸ“± ×©×•×œ×— ×”×•×“×¢×” ×œ×›×œ ×”×× ×•×™×™× ×”××ª××™××™× ×œ××©×¨×” ${jobId}`);
            
            // ×¡×’×™×¨×ª ×”××•×“×œ
            document.querySelector('.preview-modal')?.remove();
            
            // ×”×•×“×¢×ª ×”×¦×œ×—×”
            const resultsDiv = document.getElementById('jobSearchResults');
            resultsDiv.innerHTML = `
                <div class="success">
                    <i class="fas fa-check-circle"></i>
                    ×”×”×•×“×¢×•×ª × ×©×œ×—×• ×‘×”×¦×œ×—×” ×œ×›×œ ×”×× ×•×™×™× ×”××ª××™××™×!
                </div>
            `;

            // ×¢×“×›×•×Ÿ ×¡×˜×˜×™×¡×˜×™×§×•×ª
            const currentAlerts = parseInt(localStorage.getItem('whatsapp_total_alerts') || '0');
            localStorage.setItem('whatsapp_total_alerts', (currentAlerts + 1).toString());
            adminPanel.updateStats();
        }

        function sendManualJob() {
            const title = document.getElementById('manualJobTitle').value.trim();
            const company = document.getElementById('manualCompany').value.trim();
            const area = document.getElementById('manualArea').value;
            const category = document.getElementById('manualCategory').value;
            
            if (!title || !company || !area || !category) {
                alert('×× × ××œ× ××ª ×›×œ ×”×©×“×•×ª');
                return;
            }

            // ×™×¦×™×¨×ª ××©×¨×” ×™×“× ×™×ª
            const manualJob = {
                id: 'manual-' + Date.now(),
                jobNumber: 'MANUAL-' + Date.now(),
                title: title,
                company: company,
                area: area,
                region: area,
                category: category,
                description: '××©×¨×” ×©×”×•×›× ×¡×” ×™×“× ×™×ª',
                status: '×¤×¢×™×œ'
            };

            const normalizedJob = correctJobsManager.normalizeJob(manualJob);
            const subscribers = adminPanel?.whatsappAlerts?.getSubscribers() || [];
            const matchingSubscribers = correctJobsManager.findMatchingSubscribers(normalizedJob, subscribers);

            // ×”×¦×’×ª ×ª×•×¦××•×ª
            const resultsDiv = document.getElementById('jobSearchResults');
            resultsDiv.innerHTML = `
                <div class="success">
                    <h4><i class="fas fa-plus-circle"></i> ××©×¨×” ×™×“× ×™×ª × ×•×¦×¨×”!</h4>
                    <div style="background: rgba(246, 152, 152, 0.1); padding: 15px; border-radius: 8px; margin: 10px 0; border: 1px solid rgba(246, 152, 152, 0.3);">
                        <strong>${normalizedJob.title}</strong><br>
                        <small>×—×‘×¨×”: ${normalizedJob.company}</small><br>
                        <small>××–×•×¨: ${normalizedJob.region}</small><br>
                        <small>×§×˜×’×•×¨×™×”: ${normalizedJob.category}</small>
                    </div>
                    <p><i class="fas fa-users"></i> × ××¦××• ${matchingSubscribers.length} ×× ×•×™×™× ××ª××™××™×</p>
                    ${matchingSubscribers.length > 0 ? 
                        `<button class="btn" onclick="sendManualJobToSubscribers('${encodeURIComponent(JSON.stringify(normalizedJob))}')">
                            <i class="fas fa-paper-plane"></i> ×©×œ×— ×œ-${matchingSubscribers.length} ×× ×•×™×™×
                        </button>` : 
                        '<p style="color: var(--primary-color);">××™×Ÿ ×× ×•×™×™× ××ª××™××™× ×œ×¤×™ ×”×§×˜×’×•×¨×™×” ×•×”××–×•×¨</p>'
                    }
                </div>
            `;

            // × ×™×§×•×™ ×”×˜×•×¤×¡
            document.getElementById('manualJobTitle').value = '';
            document.getElementById('manualCompany').value = '';
            document.getElementById('manualArea').value = '';
            document.getElementById('manualCategory').value = '';
        }

        function sendManualJobToSubscribers(jobJson) {
            const job = JSON.parse(decodeURIComponent(jobJson));
            const subscribers = adminPanel?.whatsappAlerts?.getSubscribers() || [];
            const matchingSubscribers = correctJobsManager.findMatchingSubscribers(job, subscribers);

            const message = `ğŸ”¥ ××©×¨×” ×—×“×©×”!

ğŸ“‹ ${job.title}
ğŸ¢ ${job.company}
ğŸ“ ${job.region}
ğŸ¯ ${job.category}

×œ×¤×¨×˜×™× × ×•×¡×¤×™×: https://www.mayeshpo.co.il

×‘×”×¦×œ×—×”! ğŸ’ª`;

            showPreview(message, matchingSubscribers, job);
        }

        // ×¤×•× ×§×¦×™×•×ª ×œ×©×œ×™×—×” ×™×©×™×¨×”
        function previewDirectMessage() {
            const subscriberIndex = document.getElementById('subscriberSelect').value;
            const message = document.getElementById('directMessage').value;
            
            if (!subscriberIndex || !message) {
                alert('×× × ×‘×—×¨ ×× ×•×™ ×•×”×›× ×¡ ×”×•×“×¢×”');
                return;
            }

            const subscribers = adminPanel?.whatsappAlerts?.getSubscribers() || [];
            const subscriber = subscribers[subscriberIndex];
            
            if (!subscriber) {
                alert('×× ×•×™ ×œ× × ××¦×');
                return;
            }

            const modal = document.createElement('div');
            modal.className = 'preview-modal';
            modal.innerHTML = `
                <div class="preview-content">
                    <h3><i class="fas fa-eye"></i> ×ª×¦×•×’×” ××§×“×™××” - ×”×•×“×¢×” ×™×©×™×¨×”</h3>
                    
                    <div style="margin: 15px 0;">
                        <strong>× ××¢×Ÿ:</strong> ${subscriber.phone} - ${subscriber.name || '×œ×œ× ×©×'}
                    </div>
                    
                    <div class="whatsapp-message">
                        ${message.replace(/\n/g, '<br>')}
                    </div>
                    
                    <div style="margin-top: 15px;">
                        <button class="btn" onclick="confirmDirectSend(${subscriberIndex}, '${message.replace(/'/g, "\\'")}')">
                            <i class="fas fa-paper-plane"></i> ×©×œ×— ×”×•×“×¢×”
                        </button>
                        <button class="close-btn" onclick="this.parentElement.parentElement.parentElement.remove()">
                            <i class="fas fa-times"></i> ×¡×’×•×¨
                        </button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
        }

        function confirmDirectSend(subscriberIndex, message) {
            const subscribers = adminPanel?.whatsappAlerts?.getSubscribers() || [];
            const subscriber = subscribers[subscriberIndex];
            
            if (!subscriber) {
                alert('×©×’×™××”: ×× ×•×™ ×œ× × ××¦×');
                return;
            }

            // ×¡×™××•×œ×¦×™×” ×©×œ ×©×œ×™×—×”
            console.log(`ğŸ“± ×©×•×œ×— ×”×•×“×¢×” ×™×©×™×¨×” ×œ-${subscriber.phone}:`, message);
            
            // ×¡×’×™×¨×ª ×”××•×“×œ
            document.querySelector('.preview-modal')?.remove();
            
            // ×”×•×“×¢×ª ×”×¦×œ×—×”
            const resultsDiv = document.getElementById('jobSearchResults');
            resultsDiv.innerHTML = `
                <div class="success">
                    <i class="fas fa-check-circle"></i>
                    ×”×•×“×¢×” × ×©×œ×—×” ×‘×”×¦×œ×—×” ×œ-${subscriber.phone}
                </div>
            `;
            
            // × ×™×§×•×™ ×”×˜×•×¤×¡
            document.getElementById('subscriberSelect').value = '';
            document.getElementById('directMessage').value = '';

            // ×¢×“×›×•×Ÿ ×¡×˜×˜×™×¡×˜×™×§×•×ª
            const currentAlerts = parseInt(localStorage.getItem('whatsapp_total_alerts') || '0');
            localStorage.setItem('whatsapp_total_alerts', (currentAlerts + 1).toString());
            adminPanel.updateStats();
        }

        function sendDirectMessage() {
            const subscriberIndex = document.getElementById('subscriberSelect').value;
            const message = document.getElementById('directMessage').value;
            
            if (!subscriberIndex || !message) {
                alert('×× × ×‘×—×¨ ×× ×•×™ ×•×”×›× ×¡ ×”×•×“×¢×”');
                return;
            }

            confirmDirectSend(subscriberIndex, message);
        }

        // ×¤×•× ×§×¦×™×•×ª ×›×œ×œ×™×•×ª
        function exportSubscribers() {
            const subscribers = adminPanel?.whatsappAlerts?.getSubscribers() || [];
            
            if (subscribers.length === 0) {
                alert('××™×Ÿ ×× ×•×™×™× ×œ×™×™×¦×•×');
                return;
        }

        // ×™×¦×™×¨×ª × ×ª×•× ×™ JSON
        const dataStr = JSON.stringify(subscribers, null, 2);
        const dataBlob = new Blob([dataStr], {type: 'application/json'});
        
        const link = document.createElement('a');
        link.href = URL.createObjectURL(dataBlob);
        link.download = `whatsapp_subscribers_${new Date().toISOString().split('T')[0]}.json`;
        
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
        
        adminPanel?.showAlert(`×™×™×¦×•× ${subscribers.length} ×× ×•×™×™× ×”×•×©×œ×!`, 'success');
    }

    function importSubscribers(event) {
        const file = event.target.files[0];
        if (!file) return;

        const reader = new FileReader();
        reader.onload = function(e) {
            try {
                const importedData = JSON.parse(e.target.result);
                
                if (!Array.isArray(importedData)) {
                    throw new Error('×§×•×‘×¥ JSON ×—×™×™×‘ ×œ×”×›×™×œ ××¢×¨×š ×©×œ ×× ×•×™×™×');
                }

                let imported = 0;
                let skipped = 0;
                
                const existingSubscribers = adminPanel?.whatsappAlerts?.getSubscribers() || [];
                
                importedData.forEach(subscriber => {
                    // ×‘×“×™×§×” ×©×”×× ×•×™ ×ª×§×™×Ÿ
                    if (subscriber.phone && subscriber.name) {
                        // ×‘×“×™×§×” ×©×”××¡×¤×¨ ×œ× ×§×™×™×
                        if (!existingSubscribers.find(sub => sub.phone === subscriber.phone)) {
                            // ×”×•×¡×¤×ª ×©×“×•×ª ×—×¡×¨×™×
                            subscriber.id = subscriber.id || Date.now() + Math.random();
                            subscriber.registrationDate = subscriber.registrationDate || new Date().toISOString();
                            subscriber.categories = subscriber.categories || ['××—×¨'];
                            subscriber.areas = subscriber.areas || ['×›×œ ×”××¨×¥'];
                            subscriber.active = subscriber.active !== false;
                            
                            adminPanel.whatsappAlerts.addSubscriber(subscriber);
                            imported++;
                        } else {
                            skipped++;
                        }
                    }
                });

                adminPanel.renderSubscribers();
                adminPanel.updateStats();
                adminPanel.loadSubscriberSelect();

                adminPanel?.showAlert(`×™×•×‘××• ${imported} ×× ×•×™×™× ×—×“×©×™×. ${skipped} ×× ×•×™×™× ×§×™×™××™× ×“×•×œ×’×•.`, 'success');
            } catch (error) {
                adminPanel?.showAlert('×©×’×™××” ×‘×§×¨×™××ª ×”×§×•×‘×¥: ' + error.message, 'error');
            }
        };
        
        reader.readAsText(file);
        event.target.value = ''; // × ×™×§×•×™ ×”×©×“×”
    }

    function clearAllData() {
        const message = '×”×× ××ª×” ×‘×˜×•×— ×©×‘×¨×¦×•× ×š ×œ××—×•×§ ××ª ×›×œ ×”× ×ª×•× ×™×?\n\nâ€¢ ×›×œ ×”×× ×•×™×™× ×™×™××—×§×•\nâ€¢ ×›×œ ×”×¡×˜×˜×™×¡×˜×™×§×•×ª ×™××•×¤×¡×•\n\n×¤×¢×•×œ×” ×–×• ×œ× × ×™×ª× ×ª ×œ×‘×™×˜×•×œ!';
        
        if (confirm(message)) {
            if (confirm('×–×•×”×™ ××–×”×¨×” ××—×¨×•× ×”! ×”×× ××ª×” ×‘×˜×•×— ×œ×’××¨×™?')) {
                // ××—×™×§×ª × ×ª×•× ×™×
                localStorage.removeItem('whatsapp_alerts_subscribers');
                localStorage.removeItem('whatsapp_total_alerts');
                localStorage.removeItem('subscribers_backup');
                
                // ××™×¤×•×¡ ×”××¢×¨×›×ª
                if (adminPanel?.whatsappAlerts) {
                    adminPanel.whatsappAlerts.subscribers = [];
                }
                
                // ×¢×“×›×•×Ÿ ×ª×¦×•×’×”
                adminPanel?.renderSubscribers();
                adminPanel?.updateStats();
                adminPanel?.loadSubscriberSelect();
                
                adminPanel?.showAlert('×›×œ ×”× ×ª×•× ×™× × ××—×§×• ×‘×”×¦×œ×—×”', 'success');
            }
        }
    }

    function generateReport() {
        const subscribers = adminPanel?.whatsappAlerts?.getSubscribers() || [];
        
        if (subscribers.length === 0) {
            alert('××™×Ÿ × ×ª×•× ×™× ×œ×™×¦×™×¨×ª ×“×•×—');
            return;
        }

        // ×—×™×©×•×‘ ×¡×˜×˜×™×¡×˜×™×§×•×ª
        const categoryStats = {};
        const areaStats = {};
        const monthlyStats = {};

        subscribers.forEach(subscriber => {
            // ×¡×˜×˜×™×¡×˜×™×§×•×ª ×§×˜×’×•×¨×™×•×ª
            if (subscriber.categories) {
                subscriber.categories.forEach(cat => {
                    categoryStats[cat] = (categoryStats[cat] || 0) + 1;
                });
            }
            
            // ×¡×˜×˜×™×¡×˜×™×§×•×ª ××–×•×¨×™×
            if (subscriber.areas) {
                subscriber.areas.forEach(area => {
                    areaStats[area] = (areaStats[area] || 0) + 1;
                });
            }
            
            // ×¡×˜×˜×™×¡×˜×™×§×•×ª ×—×•×“×©×™×•×ª
            if (subscriber.registrationDate) {
                const month = new Date(subscriber.registrationDate).toISOString().slice(0, 7);
                monthlyStats[month] = (monthlyStats[month] || 0) + 1;
            }
        });

        // ×™×¦×™×¨×ª ×”×“×•×—
        const now = new Date();
        const totalAlerts = localStorage.getItem('whatsapp_total_alerts') || '0';
        
        let report = `×“×•×— ××¤×•×¨×˜ - ××¢×¨×›×ª ×”×ª×¨××•×ª WhatsApp "××” ×™×© ×¤×”?"\n`;
        report += `×ª××¨×™×š ×™×¦×™×¨×ª ×”×“×•×—: ${now.toLocaleDateString('he-IL')} ${now.toLocaleTimeString('he-IL')}\n`;
        report += `${'='.repeat(60)}\n\n`;
        
        // ×¡×˜×˜×™×¡×˜×™×§×•×ª ×›×œ×œ×™×•×ª
        report += `ğŸ“Š ×¡×˜×˜×™×¡×˜×™×§×•×ª ×›×œ×œ×™×•×ª:\n`;
        report += `â€¢ ×¡×”"×› ×× ×•×™×™× ×¤×¢×™×œ×™×: ${subscribers.length}\n`;
        report += `â€¢ ×¡×”"×› ×”×ª×¨××•×ª × ×©×œ×—×•: ${totalAlerts}\n`;
        report += `â€¢ ×××•×¦×¢ ×”×ª×¨××•×ª ×œ×× ×•×™: ${(parseInt(totalAlerts) / Math.max(subscribers.length, 1)).toFixed(1)}\n\n`;
        
        // ×”×ª×¤×œ×’×•×ª ×œ×¤×™ ×§×˜×’×•×¨×™×•×ª
        report += `ğŸ“ˆ ×”×ª×¤×œ×’×•×ª ×œ×¤×™ ×§×˜×’×•×¨×™×•×ª:\n`;
        Object.entries(categoryStats)
            .sort((a, b) => b[1] - a[1])
            .forEach(([cat, count]) => {
                const percentage = ((count / subscribers.length) * 100).toFixed(1);
                report += `â€¢ ${cat}: ${count} ×× ×•×™×™× (${percentage}%)\n`;
            });
        
        // ×”×ª×¤×œ×’×•×ª ×œ×¤×™ ××–×•×¨×™×
        report += `\nğŸ—ºï¸ ×”×ª×¤×œ×’×•×ª ×œ×¤×™ ××–×•×¨×™×:\n`;
        Object.entries(areaStats)
            .sort((a, b) => b[1] - a[1])
            .forEach(([area, count]) => {
                const percentage = ((count / subscribers.length) * 100).toFixed(1);
                report += `â€¢ ${area}: ${count} ×× ×•×™×™× (${percentage}%)\n`;
            });
        
        // ×”×ª×¤×œ×’×•×ª ×—×•×“×©×™×ª
        report += `\nğŸ“… ×”×ª×¤×œ×’×•×ª ×”×¨×©××•×ª ×œ×¤×™ ×—×•×“×©×™×:\n`;
        Object.entries(monthlyStats)
            .sort((a, b) => b[0].localeCompare(a[0]))
            .slice(0, 6) // 6 ×—×•×“×©×™× ××—×¨×•× ×™×
            .forEach(([month, count]) => {
                const monthName = new Date(month + '-01').toLocaleDateString('he-IL', { year: 'numeric', month: 'long' });
                report += `â€¢ ${monthName}: ${count} ×”×¨×©××•×ª\n`;
            });

        // ×”×¦×’×ª ×”×“×•×—
        const modal = document.createElement('div');
        modal.className = 'preview-modal';
        modal.innerHTML = `
            <div class="preview-content" style="max-width: 700px;">
                <h3><i class="fas fa-chart-bar"></i> ×“×•×— ×¡×˜×˜×™×¡×˜×™×§×•×ª ××¤×•×¨×˜</h3>
                
                <div style="margin: 20px 0;">
                    <pre style="color: white; white-space: pre-wrap; line-height: 1.6; background: rgba(246, 152, 152, 0.1); padding: 20px; border-radius: 8px; max-height: 400px; overflow-y: auto; border: 1px solid rgba(246, 152, 152, 0.3);">${report}</pre>
                </div>
                
                <div style="display: flex; gap: 15px; justify-content: center; margin-top: 20px;">
                    <button onclick="navigator.clipboard.writeText(\`${report.replace(/`/g, '\\`')}\`).then(() => alert('×“×•×— ×”×•×¢×ª×§ ×œ×œ×•×—!'))" class="btn">
                        <i class="fas fa-copy"></i> ×”×¢×ª×§ ×“×•×—
                    </button>
                    <button onclick="downloadReport(\`${report.replace(/`/g, '\\`').replace(/\n/g, '\\n')}\`)" class="btn btn-secondary">
                        <i class="fas fa-download"></i> ×”×•×¨×“ ×“×•×—
                    </button>
                    <button onclick="this.closest('.preview-modal').remove()" class="close-btn">
                        <i class="fas fa-times"></i> ×¡×’×•×¨
                    </button>
                </div>
            </div>
        `;
        
        document.body.appendChild(modal);
    }

    function downloadReport(reportText) {
        const blob = new Blob(['\uFEFF' + reportText], { type: 'text/plain;charset=utf-8;' });
        const link = document.createElement('a');
        const url = URL.createObjectURL(blob);
        
        link.setAttribute('href', url);
        link.setAttribute('download', `whatsapp_report_${new Date().toISOString().split('T')[0]}.txt`);
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
        
        URL.revokeObjectURL(url);
    }

    function refreshSubscribersList() {
        console.log('ğŸ”„ ××¨×¢× ×Ÿ ×¨×©×™××ª ×× ×•×™×™×...');
        
        // ×¢×“×›×•×Ÿ ×”×˜×‘×œ×”
        if (adminPanel) {
            adminPanel.renderSubscribers();
            adminPanel.updateStats();
            adminPanel.loadSubscriberSelect();
        }
        
        adminPanel?.showAlert('âœ… ×¨×©×™××ª ×”×× ×•×™×™× ×¨×•×¢× × ×”!', 'success');
    }

    // ×¤×•× ×§×¦×™×•×ª ×œ×›×œ×™ ×¤×™×ª×•×—
    function analyzeCorrectJobsStructure() {
        const jobs = correctJobsManager.getAllJobs();
        
        if (!jobs || jobs.length === 0) {
            console.log('âŒ ××™×Ÿ ××©×¨×•×ª ×œ× ×™×ª×•×—');
            return;
        }

        console.log(`ğŸ” × ×™×ª×•×— ××‘× ×” ×©×œ ${jobs.length} ××©×¨×•×ª:`);
        
        // × ×™×ª×•×— ×”×©×“×•×ª ×”×§×™×™××™×
        const fieldAnalysis = {};
        const sampleJob = jobs[0];
        
        Object.keys(sampleJob).forEach(field => {
            const valuesSet = new Set();
            jobs.slice(0, 10).forEach(job => {
                if (job[field]) valuesSet.add(job[field]);
            });
            
            fieldAnalysis[field] = {
                type: typeof sampleJob[field],
                sampleValues: Array.from(valuesSet).slice(0, 3),
                totalFound: jobs.filter(job => job[field]).length
            };
        });

        console.table(fieldAnalysis);
        
        // ×“×•×’××ª ××©×¨×” ××œ××”
        console.log('ğŸ“ ×“×•×’××ª ××©×¨×” ××œ××”:');
        console.log(JSON.stringify(sampleJob, null, 2));
        
        // ×‘×“×™×§×ª ××™×›×•×ª × ×ª×•× ×™×
        const qualityReport = {
            totalJobs: jobs.length,
            withJobNumber: jobs.filter(j => j.jobNumber).length,
            withTitle: jobs.filter(j => j.title).length,
            withCategory: jobs.filter(j => j.category).length,
            withRegion: jobs.filter(j => j.region || j.area).length,
            activeJobs: jobs.filter(j => j.status === '×¤×¢×™×œ').length
        };
        
        console.log('ğŸ“Š ×“×•×— ××™×›×•×ª × ×ª×•× ×™×:');
        console.table(qualityReport);
        
        return qualityReport;
    }

    function testJobSearchDemo() {
        console.log('ğŸ§ª ×”×ª×—×œ×ª ×‘×“×™×§×ª ××¢×¨×›×ª ×”×—×™×¤×•×©...');
        
        const testCases = ['A-25821', '12345', '××©××™×ª', 'Full Stack'];
        
        testCases.forEach(testCase => {
            console.log(`\n--- ×‘×“×™×§×”: ${testCase} ---`);
            const job = correctJobsManager.findJobById(testCase);
            
            if (job) {
                console.log('âœ… ××©×¨×” × ××¦××”:');
                console.log(`   ××¡×¤×¨: ${job.jobNumber}`);
                console.log(`   ×›×•×ª×¨×ª: ${job.title}`);
                console.log(`   ×§×˜×’×•×¨×™×”: ${job.category}`);
                console.log(`   ××–×•×¨: ${job.region || job.area}`);
                console.log(`   ×¡×˜×˜×•×¡: ${job.status}`);
            } else {
                console.log('âŒ ××©×¨×” ×œ× × ××¦××”');
            }
        });
        
        console.log('\nâœ… ×‘×“×™×§×ª ×”×—×™×¤×•×© ×”×•×©×œ××” - ×¨××” ×ª×•×¦××•×ª ×‘×§×•× ×¡×•×œ');
    }

    function showJobFormats() {
        const modal = document.createElement('div');
        modal.className = 'preview-modal';
        modal.innerHTML = `
            <div class="preview-content">
                <h3><i class="fas fa-list"></i> ×¤×•×¨××˜×™× × ×ª××›×™× ×œ××©×¨×•×ª</h3>
                
                <h4>ğŸ“‹ ×©×“×•×ª ×—×•×‘×”:</h4>
                <pre style="background: rgba(246, 152, 152, 0.1); padding: 10px; border-radius: 5px; border: 1px solid rgba(246, 152, 152, 0.3);">
{
  "jobNumber": "A-25821",
  "title": "× ×”×’/×ª ××©××™×ª ×× ×•×£ ××¢×œ 15 ×˜×•×Ÿ",
  "category": "×œ×•×’×™×¡×˜×™×§×”, ××—×¡× ×™×, ×©×™×œ×•×— ×•×¨×›×©",
  "region": "×“×¨×•×",
  "city": "××©×“×•×“",
  "status": "×¤×¢×™×œ"
}</pre>

                <h4>ğŸ“‹ ×©×“×•×ª ××•×¤×¦×™×•× ×œ×™×™×:</h4>
                <pre style="background: rgba(246, 152, 152, 0.1); padding: 10px; border-radius: 5px; border: 1px solid rgba(246, 152, 152, 0.3);">
{
  "company": "×©× ×”×—×‘×¨×”",
  "description": "×ª×™××•×¨ ×”××©×¨×”",
  "requirements": "×“×¨×™×©×•×ª",
  "salary": "×©×›×¨",
  "featured": false
}</pre>

                <h4>ğŸ” ×©×“×•×ª ×—×™×¤×•×©:</h4>
                <ul style="color: white;">
                    <li><strong>jobNumber</strong> - ××¡×¤×¨ ×”××©×¨×” ×”×¨×©××™</li>
                    <li><strong>title</strong> - ×›×•×ª×¨×ª ×”××©×¨×”</li>
                    <li><strong>company</strong> - ×©× ×”×—×‘×¨×”</li>
                    <li><strong>region</strong> - ××–×•×¨ ×’×™××•×’×¨×¤×™</li>
                    <li><strong>category</strong> - ×§×˜×’×•×¨×™×ª ×”××©×¨×”</li>
                </ul>

                <button class="close-btn" onclick="this.parentElement.parentElement.remove()">
                    <i class="fas fa-times"></i> ×¡×’×•×¨
                </button>
            </div>
        `;
        
        document.body.appendChild(modal);
    }

    function testMatchingDemo() {
        const jobs = correctJobsManager.getAllJobs();
        const subscribers = adminPanel?.whatsappAlerts?.getSubscribers() || [];
        
        if (jobs.length === 0 || subscribers.length === 0) {
            alert('×¦×¨×™×š ××©×¨×•×ª ×•×× ×•×™×™× ×›×“×™ ×œ×‘×“×•×§ ×”×ª×××”');
            return;
        }

        const testJob = jobs[0];
        const normalizedJob = correctJobsManager.normalizeJob(testJob);
        const matches = correctJobsManager.findMatchingSubscribers(normalizedJob, subscribers);

        const modal = document.createElement('div');
        modal.className = 'preview-modal';
        modal.innerHTML = `
            <div class="preview-content">
                <h3><i class="fas fa-users"></i> ×‘×“×™×§×ª ×”×ª×××ª ×× ×•×™×™×</h3>
                
                <h4>ğŸ“‹ ××©×¨×” ×œ×‘×“×™×§×”:</h4>
                <div style="background: rgba(246, 152, 152, 0.1); padding: 15px; border-radius: 8px; margin: 10px 0; border: 1px solid rgba(246, 152, 152, 0.3);">
                    <strong>${normalizedJob.title}</strong><br>
                    <small>×§×˜×’×•×¨×™×”: ${normalizedJob.category}</small><br>
                    <small>××–×•×¨: ${normalizedJob.region}</small>
                </div>

                <h4>ğŸ‘¥ ×× ×•×™×™× ××ª××™××™× (${matches.length}):</h4>
                <div style="max-height: 200px; overflow-y: auto;">
                    ${matches.length > 0 ? 
                        matches.map(sub => `
                            <div style="background: rgba(246, 152, 152, 0.1); padding: 10px; margin: 5px 0; border-radius: 5px;">
                                ğŸ“± ${sub.phone} - ${sub.name || '×œ×œ× ×©×'}<br>
                                <small>×§×˜×’×•×¨×™×•×ª: ${sub.categories.join(', ')}</small><br>
                                <small>××–×•×¨×™×: ${sub.areas.join(', ')}</small>
                            </div>
                        `).join('') : 
                        '<p>××™×Ÿ ×× ×•×™×™× ××ª××™××™×</p>'
                    }
                </div>

                <h4>ğŸ“Š ×¡×™×›×•×:</h4>
                <p>××ª×•×š ${subscribers.length} ×× ×•×™×™×, ${matches.length} ××ª××™××™× ×œ××©×¨×” ×–×•</p>

                <button class="close-btn" onclick="this.parentElement.parentElement.remove()">
                    <i class="fas fa-times"></i> ×¡×’×•×¨
                </button>
            </div>
        `;
        
        document.body.appendChild(modal);
    }

    function testCategoryMatching() {
        const testCases = [
            {
                jobCategory: '×œ×•×’×™×¡×˜×™×§×”, ××—×¡× ×™×, ×©×™×œ×•×— ×•×¨×›×©',
                subscriberCategories: ['×œ×•×’×™×¡×˜×™×§×”'],
                expected: true
            },
            {
                jobCategory: '×œ×•×’×™×¡×˜×™×§×”, ××—×¡× ×™×, ×©×™×œ×•×— ×•×¨×›×©',
                subscriberCategories: ['× ×”×™×’×”'],
                expected: true
            },
            {
                jobCategory: '×¤×™×ª×•×— ×•×ª×•×›× ×”',
                subscriberCategories: ['××¤×ª×—'],
                expected: true
            }
        ];
        
        console.log('ğŸ§ª ×‘×“×™×§×ª ××¢×¨×›×ª ×”×ª×××ª ×§×˜×’×•×¨×™×•×ª:');
        
        testCases.forEach((test, index) => {
            const result = correctJobsManager.matchCategory(test.jobCategory, test.subscriberCategories);
            const status = result === test.expected ? 'âœ…' : 'âŒ';
            
            console.log(`${status} ×‘×“×™×§×” ${index + 1}:`);
            console.log(`  ××©×¨×”: ${test.jobCategory}`);
            console.log(`  ×× ×•×™: ${test.subscriberCategories.join(', ')}`);
            console.log(`  ×ª×•×¦××”: ${result} (×¦×¤×•×™: ${test.expected})`);
        });
    }

    function checkGitConnection() {
        adminPanel?.checkGitConnection();
    }

    function refreshJobsFromGit() {
        correctJobsManager?.loadJobs();
        adminPanel?.showAlert('××©×¨×•×ª ×¨×•×¢× × ×• ××’×™×˜', 'success');
    }

    function showJobsStats() {
        const stats = correctJobsManager.getJobsStats();
        const statusDiv = document.getElementById('jobs-stats');
        const contentDiv = document.getElementById('jobs-stats-content');
        
        if (!statusDiv || !contentDiv) return;
        
        if (stats.total === 0) {
            contentDiv.innerHTML = `
                <div style="color: #dc3545; text-align: center; padding: 20px;">
                    <i class="fas fa-exclamation-triangle" style="font-size: 2rem; margin-bottom: 10px;"></i>
                    <h4>××™×Ÿ ××©×¨×•×ª ×˜×¢×•× ×•×ª</h4>
                    <p>×‘×“×•×§ ×©×”×§×•×‘×¥ data/jobs.json ×§×™×™× ×•× ×’×™×©</p>
                    <button onclick="refreshJobsFromGit()" class="btn btn-secondary" style="margin-top: 10px;">
                        <i class="fas fa-sync-alt"></i> × ×¡×” ×©×•×‘
                    </button>
                </div>
            `;
        } else {
            const topCategories = Object.entries(stats.categories)
                .sort((a, b) => b[1] - a[1])
                .slice(0, 5);
                
            const topAreas = Object.entries(stats.regions)
                .sort((a, b) => b[1] - a[1])
                .slice(0, 5);
            
            contentDiv.innerHTML = `
                <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px;">
                    <div>
                        <h5 style="color: var(--primary-color); margin-bottom: 10px;">
                            <i class="fas fa-briefcase"></i> ×¡×”"×› ××©×¨×•×ª: ${stats.total}
                        </h5>
                        <div style="color: #25D366;">
                            <i class="fas fa-star"></i> ×¤×¢×™×œ×•×ª: ${stats.status['×¤×¢×™×œ'] || 0}
                        </div>
                        <div style="margin-top: 10px; font-size: 0.9em; color: #999;">
                            ×¢×“×›×•×Ÿ: ${stats.lastUpdate ? stats.lastUpdate.toLocaleString('he-IL') : '×œ× ×™×“×•×¢'}
                        </div>
                    </div>
                    
                    <div>
                        <h6 style="color: var(--primary-color); margin-bottom: 8px;">×§×˜×’×•×¨×™×•×ª ××•×‘×™×œ×•×ª:</h6>
                        ${topCategories.map(([cat, count]) => 
                            `<div style="font-size: 0.9em;">â€¢ ${cat}: ${count}</div>`
                        ).join('')}
                    </div>
                    
                    <div>
                        <h6 style="color: var(--primary-color); margin-bottom: 8px;">××–×•×¨×™× ××•×‘×™×œ×™×:</h6>
                        ${topAreas.map(([area, count]) => 
                            `<div style="font-size: 0.9em;">â€¢ ${area}: ${count}</div>`
                        ).join('')}
                    </div>
                </div>
                
                <div style="margin-top: 15px; text-align: center;">
                    <button onclick="refreshJobsFromGit()" class="btn btn-secondary">
                        <i class="fas fa-sync-alt"></i> ×¨×¢× ×Ÿ ××”×’×™×˜
                    </button>
                </div>
            `;
        }
        
        statusDiv.style.display = 'block';
    }

    function showRecentJobs() {
        const jobs = correctJobsManager.getAllJobs();
        const recentSection = document.getElementById('recent-jobs-section');
        const contentDiv = document.getElementById('recent-jobs-content');
        
        if (!recentSection || !contentDiv) return;
        
        // ××©×¨×•×ª ××”×©×‘×•×¢ ×”××—×¨×•×Ÿ
        const oneWeekAgo = new Date();
        oneWeekAgo.setDate(oneWeekAgo.getDate() - 7);
        
        const recentJobs = jobs.filter(job => {
            if (!job.createdAt) return false;
            const jobDate = new Date(job.createdAt);
            return jobDate >= oneWeekAgo;
        }).slice(0, 10);

        if (recentJobs.length === 0) {
            contentDiv.innerHTML = '<p>××™×Ÿ ××©×¨×•×ª ×—×“×©×•×ª ×”×©×‘×•×¢</p>';
        } else {
            let html = `
                <div style="margin-bottom: 15px;">
                    <strong>${recentJobs.length} ××©×¨×•×ª ×—×“×©×•×ª ×”×©×‘×•×¢</strong>
                </div>
                <div style="display: grid; gap: 15px;">
            `;

            recentJobs.forEach(job => {
                const normalized = correctJobsManager.normalizeJob(job);
                html += `
                    <div style="background: rgba(37, 211, 102, 0.1); border: 1px solid rgba(37, 211, 102, 0.3); border-radius: 8px; padding: 15px;">
                        <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 10px;">
                            <div>
                                <strong style="color: #25D366;">${normalized.title}</strong><br>
                                <small style="color: #666;">${normalized.company}</small>
                            </div>
                            <span style="background: #25D366; color: white; padding: 2px 8px; border-radius: 12px; font-size: 0.8em;">
                                ${normalized.jobNumber}
                            </span>
                        </div>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; font-size: 0.9em;">
                            <div><i class="fas fa-map-marker-alt"></i> ${normalized.region}</div>
                            <div><i class="fas fa-tag"></i> ${normalized.category}</div>
                        </div>
                        <div style="margin-top: 10px;">
                            <button class="btn" onclick="quickSendJob('${normalized.jobNumber}')" style="padding: 5px 10px; font-size: 0.8em;">
                                <i class="fas fa-paper-plane"></i> ×©×œ×— ×œ×× ×•×™×™×
                            </button>
                        </div>
                    </div>
                `;
            });

            html += '</div>';
            contentDiv.innerHTML = html;
        }
        
        recentSection.style.display = 'block';
    }

    function quickSendJob(jobNumber) {
        document.getElementById('jobSearchInput').value = jobNumber;
        searchJobAndSend();
    }

    function testGitConnection() {
        correctJobsManager.loadJobs()
            .then(() => {
                adminPanel?.showAlert('×—×™×‘×•×¨ ×œ×’×™×˜ ×¢×•×‘×“!', 'success');
            })
            .catch(() => {
                adminPanel?.showAlert('×‘×¢×™×” ×‘×—×™×‘×•×¨ ×œ×’×™×˜', 'error');
            });
    }

    // ××ª×—×•×œ ×”×¤×× ×œ
    let adminPanel;
    document.addEventListener('DOMContentLoaded', function() {
        // ×”××ª×Ÿ ×§×¦×ª ×œ×˜×¢×™× ×” ××œ××”
        setTimeout(() => {
            adminPanel = new AdminPanel();
            
            console.log('ğŸš€ ×¤×× ×œ × ×™×”×•×œ ×× ×•×™×™× ×”×•×¤×¢×œ ×‘×”×¦×œ×—×”!');
            console.log('ğŸ¨ ×¢×•×¦×‘ ×‘×’×•×•× ×™× ×•×¨×•×“×™× ×©×œ ×”××ª×¨ "××” ×™×© ×¤×”?"');
        }, 1000);
        
        // ×¢×“×›×•×Ÿ ××•×˜×•××˜×™ ×›×œ 30 ×©× ×™×•×ª
        setInterval(() => {
            if (adminPanel) {
                adminPanel.updateStats();
            }
        }, 30000);
    });

    // ×¡×’×™×¨×ª ××•×“×œ×™× ×‘×œ×—×™×¦×” ×¢×œ ×”×¨×§×¢
    document.addEventListener('click', function(e) {
        if (e.target.classList.contains('preview-modal')) {
            e.target.remove();
        }
    });
    </script>
</body>
</html>
