<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>מה יש פה? - מערכת ניהול מתקדמת</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>⚙️</text></svg>">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
            color: #ffffff;
            line-height: 1.6;
            direction: rtl;
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* Header */
        .header {
            background: linear-gradient(135deg, #2a2a2a 0%, #3a3a3a 100%);
            padding: 1rem 0;
            border-bottom: 3px solid #F69898;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
        }

        .header-inner {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .text-logo {
            color: #F69898;
            font-size: 1.8rem;
            font-weight: bold;
            text-shadow: 0 2px 5px rgba(246,152,152,0.3);
        }

        .header-actions {
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .sync-status {
            display: flex;
            align-items: center;
            gap: 8px;
            background: rgba(0,0,0,0.3);
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
        }

        .sync-indicator {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #28a745;
            animation: pulse 2s infinite;
        }

        .sync-indicator.syncing {
            background: #ffc107;
            animation: spin 1s linear infinite;
        }

        .sync-indicator.error {
            background: #dc3545;
            animation: none;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .main-nav ul {
            display: flex;
            list-style: none;
            gap: 2rem;
        }

        .main-nav a {
            color: #ffffff;
            text-decoration: none;
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            transition: all 0.3s;
            font-weight: 500;
        }

        .main-nav a:hover,
        .main-nav a.active {
            background: linear-gradient(135deg, #F69898, #ff9e9e);
            color: #ffffff;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(246,152,152,0.3);
        }

        /* Login Section */
        #adminLoginSection {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
            background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 9999;
        }

        .admin-login-box {
            background: linear-gradient(135deg, #333333 0%, #444444 100%);
            border-radius: 20px;
            padding: 50px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.5);
            width: 100%;
            max-width: 500px;
            text-align: center;
            border: 2px solid #F69898;
            position: relative;
            overflow: hidden;
        }

        .admin-login-box::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(246,152,152,0.1) 0%, transparent 70%);
            animation: rotate 20s linear infinite;
            z-index: -1;
        }

        @keyframes rotate {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .admin-login-title {
            color: #F69898;
            font-size: 2.5rem;
            margin-bottom: 40px;
            font-weight: bold;
            text-shadow: 0 2px 10px rgba(246,152,152,0.3);
        }

        #adminContentSection {
            display: none;
            padding: 2rem 0;
            animation: fadeIn 0.5s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .admin-access-button {
            position: fixed;
            right: 20px;
            top: 50%;
            transform: translateY(-50%);
            background: linear-gradient(135deg, #F69898, #ff9e9e);
            color: white;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 1.5rem;
            box-shadow: 0 8px 20px rgba(246,152,152,0.4);
            cursor: pointer;
            z-index: 999;
            transition: all 0.3s ease;
            border: none;
        }

        .admin-access-button:hover {
            transform: translateY(-50%) scale(1.1);
            box-shadow: 0 12px 30px rgba(246,152,152,0.6);
        }

        /* Form Styles */
        .form-group {
            margin-bottom: 1.5rem;
            position: relative;
        }

        .form-label {
            display: block;
            margin-bottom: 0.75rem;
            color: #F69898;
            font-weight: bold;
            font-size: 1.1rem;
        }

        .form-input, .form-control {
            width: 100%;
            padding: 1rem;
            border: 2px solid #555;
            border-radius: 10px;
            background: linear-gradient(135deg, #2a2a2a 0%, #333333 100%);
            color: #ffffff;
            font-size: 1.1rem;
            transition: all 0.3s ease;
        }

        .form-input:focus, .form-control:focus {
            outline: none;
            border-color: #F69898;
            box-shadow: 0 0 20px rgba(246, 152, 152, 0.3);
            transform: translateY(-2px);
        }

        /* Button Styles */
        .btn {
            padding: 1rem 2rem;
            background: linear-gradient(135deg, #F69898, #ff9e9e);
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1.1rem;
            font-weight: bold;
            transition: all 0.3s;
            text-decoration: none;
            display: inline-block;
            text-align: center;
            box-shadow: 0 5px 15px rgba(246,152,152,0.3);
        }

        .btn:hover {
            background: linear-gradient(135deg, #e58080, #ff8a8a);
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(246,152,152,0.5);
        }

        .btn-secondary {
            background: linear-gradient(135deg, #666, #777);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }

        .btn-secondary:hover {
            background: linear-gradient(135deg, #777, #888);
        }

        .btn-sm {
            padding: 0.5rem 1rem;
            font-size: 0.9rem;
        }

        .btn-view {
            background: linear-gradient(135deg, #28a745, #20c997);
        }

        .btn-edit {
            background: linear-gradient(135deg, #ffc107, #ffcd39);
            color: #000;
        }

        .btn-delete {
            background: linear-gradient(135deg, #dc3545, #e74c3c);
        }

        .btn-featured {
            background: linear-gradient(135deg, #8B5CF6, #A855F7);
        }

        /* Page Title */
        .page-title {
            text-align: center;
            color: #F69898;
            font-size: 3rem;
            margin-bottom: 3rem;
            text-shadow: 0 4px 15px rgba(246,152,152,0.3);
            position: relative;
        }

        .page-title::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 100px;
            height: 4px;
            background: linear-gradient(135deg, #F69898, #ff9e9e);
            border-radius: 2px;
        }

        /* Admin Section */
        .admin-section {
            margin-bottom: 4rem;
        }

        .admin-title {
            color: #F69898;
            font-size: 2rem;
            margin-bottom: 2rem;
            text-align: center;
            position: relative;
        }

        .admin-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 2rem;
            margin-bottom: 2rem;
        }

        .admin-card {
            background: linear-gradient(135deg, #333 0%, #444 100%);
            padding: 2.5rem;
            border-radius: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid transparent;
            position: relative;
            overflow: hidden;
        }

        .admin-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(246,152,152,0.1), transparent);
            transition: left 0.5s;
        }

        .admin-card:hover::before {
            left: 100%;
        }

        .admin-card:hover {
            transform: translateY(-10px);
            border-color: #F69898;
            box-shadow: 0 20px 40px rgba(246, 152, 152, 0.3);
        }

        .admin-icon {
            font-size: 4rem;
            color: #F69898;
            margin-bottom: 1.5rem;
            text-shadow: 0 4px 15px rgba(246,152,152,0.3);
        }

        .admin-card-title {
            font-size: 1.4rem;
            font-weight: bold;
            margin-bottom: 1rem;
            color: #ffffff;
        }

        .admin-card-desc {
            color: #cccccc;
            line-height: 1.6;
        }

        /* Statistics Cards */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 2rem;
            margin: 2rem 0;
        }

        .stat-card {
            background: linear-gradient(135deg, #2a2a2a 0%, #3a3a3a 100%);
            padding: 2rem;
            border-radius: 15px;
            text-align: center;
            border: 2px solid #444;
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            border-color: #F69898;
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(246,152,152,0.2);
        }

        .stat-number {
            font-size: 3rem;
            font-weight: bold;
            color: #F69898;
            margin-bottom: 0.5rem;
            text-shadow: 0 2px 10px rgba(246,152,152,0.3);
        }

        .stat-label {
            color: #cccccc;
            font-size: 1.1rem;
        }

        /* Table Styles */
        .table-container {
            overflow-x: auto;
            background: linear-gradient(135deg, #333 0%, #444 100%);
            border-radius: 15px;
            margin-top: 2rem;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .jobs-table {
            width: 100%;
            border-collapse: collapse;
        }

        .jobs-table th,
        .jobs-table td {
            padding: 15px;
            text-align: center;
            border-bottom: 1px solid #555;
        }

        .jobs-table th {
            background: linear-gradient(135deg, #F69898, #ff9e9e);
            color: white;
            font-weight: bold;
            position: sticky;
            top: 0;
            text-shadow: 0 2px 5px rgba(0,0,0,0.3);
        }

        .jobs-table tr:hover {
            background: rgba(246,152,152,0.1);
            transform: scale(1.01);
            transition: all 0.3s ease;
        }

        .jobs-table tr.featured-row {
            background: linear-gradient(135deg, rgba(139,92,246,0.1), rgba(168,85,247,0.1));
            border-left: 4px solid #8B5CF6;
        }

        .action-buttons {
            display: flex;
            gap: 0.5rem;
            justify-content: center;
            flex-wrap: wrap;
        }

        .status-active {
            color: #28a745;
            font-weight: bold;
            text-shadow: 0 2px 5px rgba(40,167,69,0.3);
        }

        .status-inactive {
            color: #dc3545;
            font-weight: bold;
            text-shadow: 0 2px 5px rgba(220,53,69,0.3);
        }

        .featured-badge {
            background: linear-gradient(135deg, #8B5CF6, #A855F7);
            color: white;
            padding: 4px 12px;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: bold;
            display: inline-block;
            margin-right: 8px;
            text-shadow: 0 2px 5px rgba(0,0,0,0.3);
        }

        /* Search and Filter Styles */
        .search-filters {
            display: grid;
            grid-template-columns: 2fr 1fr 1fr 1fr;
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .filter-buttons {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            justify-content: center;
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            z-index: 9999;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.8);
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background: linear-gradient(135deg, #333 0%, #444 100%);
            margin: 2% auto;
            padding: 0;
            border-radius: 20px;
            width: 90%;
            max-width: 900px;
            position: relative;
            max-height: 95vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0,0,0,0.5);
            border: 2px solid #F69898;
        }

        .modal-header {
            background: linear-gradient(135deg, #F69898, #ff9e9e);
            color: white;
            padding: 25px;
            border-radius: 20px 20px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-title {
            margin: 0;
            font-size: 1.8rem;
            font-weight: bold;
            text-shadow: 0 2px 5px rgba(0,0,0,0.3);
        }

        .close {
            color: white;
            font-size: 32px;
            font-weight: bold;
            cursor: pointer;
            line-height: 1;
            transition: all 0.3s ease;
            width: 45px;
            height: 45px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            background: rgba(255,255,255,0.1);
        }

        .close:hover {
            background: rgba(255,255,255,0.2);
            transform: scale(1.1);
        }

        /* Form Grid */
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            padding: 2rem;
        }

        .form-buttons {
            display: flex;
            gap: 1rem;
            justify-content: flex-end;
            padding: 2rem;
            border-top: 2px solid #555;
        }

        .form-required {
            color: #F69898;
        }

        .form-help {
            font-size: 0.9rem;
            color: #aaa;
            margin-top: 0.5rem;
            font-style: italic;
        }

        .featured-toggle {
            display: flex;
            align-items: center;
            gap: 10px;
            background: linear-gradient(135deg, rgba(139,92,246,0.1), rgba(168,85,247,0.1));
            padding: 15px;
            border-radius: 10px;
            border: 2px solid #8B5CF6;
        }

        .toggle-switch {
            position: relative;
            width: 60px;
            height: 30px;
            background: #555;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .toggle-switch.active {
            background: linear-gradient(135deg, #8B5CF6, #A855F7);
        }

        .toggle-switch::before {
            content: '';
            position: absolute;
            top: 3px;
            left: 3px;
            width: 24px;
            height: 24px;
            background: white;
            border-radius: 50%;
            transition: all 0.3s ease;
            box-shadow: 0 2px 5px rgba(0,0,0,0.3);
        }

        .toggle-switch.active::before {
            left: 33px;
        }

        /* Import/Export Section */
        .import-section {
            padding: 2rem;
        }

        .file-upload {
            border: 3px dashed #F69898;
            border-radius: 15px;
            padding: 4rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            margin: 2rem 0;
            background: linear-gradient(135deg, rgba(246,152,152,0.05), rgba(246,152,152,0.1));
        }

        .file-upload:hover {
            background: linear-gradient(135deg, rgba(246,152,152,0.1), rgba(246,152,152,0.2));
            border-color: #ff9e9e;
            transform: translateY(-5px);
        }

        .file-upload-icon {
            font-size: 4rem;
            color: #F69898;
            margin-bottom: 1rem;
        }

        /* Notifications */
        .notification {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: linear-gradient(135deg, #28a745, #20c997);
            color: white;
            padding: 20px 25px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(40,167,69,0.3);
            z-index: 10000;
            display: none;
            animation: slideIn 0.5s ease-out;
            max-width: 400px;
        }

        .notification.error {
            background: linear-gradient(135deg, #dc3545, #e74c3c);
            box-shadow: 0 10px 30px rgba(220,53,69,0.3);
        }

        .notification.warning {
            background: linear-gradient(135deg, #ffc107, #ffcd39);
            color: #000;
            box-shadow: 0 10px 30px rgba(255,193,7,0.3);
        }

        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        /* Pagination */
        .pagination {
            display: flex;
            justify-content: center;
            gap: 0.5rem;
            margin-top: 3rem;
        }

        .page-item {
            padding: 0.75rem 1.25rem;
            background: linear-gradient(135deg, #555, #666);
            color: white;
            cursor: pointer;
            border-radius: 10px;
            transition: all 0.3s;
            font-weight: bold;
        }

        .page-item:hover,
        .page-item.active {
            background: linear-gradient(135deg, #F69898, #ff9e9e);
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(246,152,152,0.3);
        }

        /* Sync Panel */
        .sync-panel {
            background: linear-gradient(135deg, #2a2a2a 0%, #3a3a3a 100%);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            border: 2px solid #444;
        }

        .sync-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .sync-item {
            background: rgba(0,0,0,0.3);
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }

        .sync-item-title {
            color: #F69898;
            font-weight: bold;
            margin-bottom: 8px;
        }

        .sync-item-status {
            font-size: 0.9rem;
            color: #ccc;
        }

        /* Back to site button */
        .back-to-site {
            position: fixed;
            top: 20px;
            right: 20px;
            background: linear-gradient(135deg, #28a745, #20c997);
            color: white;
            padding: 12px 20px;
            border-radius: 25px;
            text-decoration: none;
            font-weight: bold;
            box-shadow: 0 5px 15px rgba(40,167,69,0.3);
            transition: all 0.3s ease;
            z-index: 1000;
        }

        .back-to-site:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(40,167,69,0.4);
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            .admin-grid {
                grid-template-columns: 1fr;
            }
            
            .search-filters {
                grid-template-columns: 1fr;
            }
            
            .filter-buttons {
                flex-direction: column;
            }
            
            .action-buttons {
                flex-direction: column;
                gap: 0.25rem;
            }
            
            .form-grid {
                grid-template-columns: 1fr;
            }
            
            .modal-content {
                width: 95%;
                margin: 5% auto;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }

            .sync-info {
                grid-template-columns: 1fr;
            }

            .page-title {
                font-size: 2rem;
            }

            .admin-login-box {
                padding: 30px;
            }
        }

        /* Error Message */
        .error-message {
            color: #ff6b6b;
            margin-top: 15px;
            display: none;
            background: rgba(255,107,107,0.1);
            padding: 10px 15px;
            border-radius: 8px;
            border: 1px solid #ff6b6b;
        }

        /* Loading Spinner */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 10001;
        }

        .loading-spinner {
            width: 60px;
            height: 60px;
            border: 4px solid rgba(246,152,152,0.3);
            border-top: 4px solid #F69898;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        /* Footer */
        .footer {
            background: linear-gradient(135deg, #2a2a2a 0%, #3a3a3a 100%);
            padding: 3rem 0;
            border-top: 3px solid #F69898;
            margin-top: 4rem;
            text-align: center;
        }

        .footer-links {
            display: flex;
            justify-content: center;
            gap: 2rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }

        .footer-link {
            color: #ffffff;
            text-decoration: none;
            transition: all 0.3s ease;
            padding: 0.5rem 1rem;
            border-radius: 8px;
        }

        .footer-link:hover {
            color: #F69898;
            background: rgba(246,152,152,0.1);
        }

        .copyright {
            text-align: center;
            color: #aaa;
            margin-top: 2rem;
            font-size: 0.9rem;
        }
    </style>
</head>
<body>
    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-spinner"></div>
    </div>

    <!-- כפתור חזרה לאתר -->
    <a href="/" class="back-to-site" id="backToSite" style="display: none;">
        <i class="fas fa-arrow-right"></i> חזור לאתר
    </a>

    <!-- כפתור צדדי לגישה לניהול -->
    <button class="admin-access-button" onclick="showLoginForm()">
        <i class="fas fa-lock"></i>
    </button>

    <!-- מסך כניסה למערכת הניהול -->
    <div id="adminLoginSection">
        <div class="admin-login-box">
            <div class="text-logo-container" style="margin: 0 0 40px 0; padding: 0;">
                <h2 class="text-logo" style="font-size: 2.5rem;">מה יש פה?</h2>
                <p style="font-size: 1.2rem; margin-bottom: 20px; color: #cccccc;">מערכת ניהול מתקדמת</p>
            </div>
            
            <h2 class="admin-login-title">כניסה למערכת</h2>
            
            <div class="form-group">
                <label class="form-label">סיסמה</label>
                <input type="password" id="adminPassword" class="form-control" placeholder="הכנס סיסמה...">
            </div>
            
            <button class="btn" onclick="checkAdminPassword()">כניסה למערכת</button>
            
            <div id="adminErrorMessage" class="error-message">
                <i class="fas fa-exclamation-triangle"></i>
                סיסמה שגויה, נסה שנית
            </div>
            
            <div style="margin-top: 40px;">
                <h4 style="color: #F69898; margin-bottom: 15px;">איך להיכנס למערכת?</h4>
                <div style="background: rgba(0,0,0,0.3); padding: 20px; border-radius: 10px; text-align: right;">
                    <p style="margin-bottom: 10px;"><strong>דרך 1:</strong> לחץ על הכפתור הצדדי בעמוד הראשי</p>
                    <p style="margin-bottom: 10px;"><strong>דרך 2:</strong> גש ל: <code style="color: #F69898;">yoursite.com/admin.html</code></p>
                    <p style="margin-bottom: 10px;"><strong>דרך 3:</strong> הוסף <code style="color: #F69898;">#admin</code> לכתובת</p>
                    <p style="color: #28a745; font-weight: bold;">הסיסמה: yarin080708</p>
                </div>
            </div>
            
            <p style="margin-top: 40px; color: #cccccc;">
                <a href="/" style="color: #F69898; text-decoration: none; font-weight: bold;">
                    <i class="fas fa-arrow-right"></i> חזרה לדף הבית
                </a>
            </p>
        </div>
    </div>

    <!-- Notification -->
    <div id="notification" class="notification">
        <i class="fas fa-check-circle"></i>
        <span id="notificationText">פעולה בוצעה בהצלחה</span>
    </div>

    <!-- תוכן ניהול המשרות -->
    <div id="adminContentSection">
        <!-- כותרת עליונה -->
        <header class="header">
            <div class="container">
                <div class="header-inner">
                    <div class="text-logo-container" style="margin: 0; padding: 0;">
                        <h2 class="text-logo">מה יש פה?</h2>
                    </div>
                    
                    <div class="header-actions">
                        <div class="sync-status" id="syncStatus">
                            <div class="sync-indicator" id="syncIndicator"></div>
                            <span id="syncText">מסונכרן</span>
                        </div>
                        
                        <nav class="main-nav" id="mainNav">
                            <ul>
                                <li><a href="/">דף הבית</a></li>
                                <li><a href="#" class="active">ניהול מתקדם</a></li>
                                <li><a href="/#contact">צור קשר</a></li>
                            </ul>
                        </nav>
                    </div>
                </div>
            </div>
        </header>

        <!-- תוכן ראשי -->
        <main class="container">
            <h1 class="page-title">
                <i class="fas fa-cogs"></i>
                מערכת ניהול מתקדמת
            </h1>

            <!-- סטטיסטיקות -->
            <section class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number" id="totalJobsCount">0</div>
                    <div class="stat-label">סה"כ משרות</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="activeJobsCount">0</div>
                    <div class="stat-label">משרות פעילות</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="featuredJobsCount">0</div>
                    <div class="stat-label">משרות מומלצות</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="categoriesCount">0</div>
                    <div class="stat-label">קטגוריות</div>
                </div>
            </section>

            <!-- פאנל סנכרון -->
            <section class="sync-panel">
                <h3 style="color: #F69898; margin-bottom: 15px;">
                    <i class="fas fa-sync-alt"></i>
                    סטטוס סנכרון מערכות
                </h3>
                <div class="sync-info">
                    <div class="sync-item">
                        <div class="sync-item-title">אתר ראשי</div>
                        <div class="sync-item-status" id="websiteSync">בודק...</div>
                    </div>
                    <div class="sync-item">
                        <div class="sync-item-title">GitHub</div>
                        <div class="sync-item-status" id="githubSync">בודק...</div>
                    </div>
                    <div class="sync-item">
                        <div class="sync-item-title">עדכון אחרון</div>
                        <div class="sync-item-status" id="lastUpdate">טוען...</div>
                    </div>
                    <div class="sync-item">
                        <div class="sync-item-title">בדיקה אחרונה</div>
                        <div class="sync-item-status" id="lastCheck">טוען...</div>
                    </div>
                </div>
            </section>
            
            <!-- כלי ניהול -->
            <section class="admin-section">
                <h2 class="admin-title">
                    <i class="fas fa-tools"></i>
                    כלי ניהול מתקדמים
                </h2>
                <div class="admin-grid">
                    <div class="admin-card" onclick="openImportModal()">
                        <div class="admin-icon"><i class="fas fa-file-import"></i></div>
                        <div class="admin-card-title">ייבוא משרות</div>
                        <div class="admin-card-desc">ייבא משרות מקובץ CSV או JSON עם מיפוי אוטומטי</div>
                    </div>
                    
                    <div class="admin-card" onclick="openAddJobModal()">
                        <div class="admin-icon"><i class="fas fa-plus-circle"></i></div>
                        <div class="admin-card-title">הוספת משרה</div>
                        <div class="admin-card-desc">הוסף משרה חדשה עם אפשרות להגדירה כמומלצת</div>
                    </div>
                    
                    <div class="admin-card" onclick="exportJobs()">
                        <div class="admin-icon"><i class="fas fa-file-export"></i></div>
                        <div class="admin-card-title">ייצוא משרות</div>
                        <div class="admin-card-desc">ייצא משרות לקובץ Excel או CSV</div>
                    </div>

                    <div class="admin-card" onclick="exportForGitHub()">
                        <div class="admin-icon"><i class="fab fa-github"></i></div>
                        <div class="admin-card-title">עדכן GitHub</div>
                        <div class="admin-card-desc">ייצוא ועדכון מאגר GitHub לסנכרון מלא</div>
                    </div>
                    
                    <div class="admin-card" onclick="manageCategories()">
                        <div class="admin-icon"><i class="fas fa-tags"></i></div>
                        <div class="admin-card-title">ניהול קטגוריות</div>
                        <div class="admin-card-desc">הוסף, ערוך ומחק קטגוריות משרות</div>
                    </div>
                    
                    <div class="admin-card" onclick="bulkActions()">
                        <div class="admin-icon"><i class="fas fa-list-check"></i></div>
                        <div class="admin-card-title">פעולות מרובות</div>
                        <div class="admin-card-desc">ביצוע פעולות על מספר משרות בו זמנית</div>
                    </div>

                    <div class="admin-card" onclick="syncAllSystems()">
                        <div class="admin-icon"><i class="fas fa-sync"></i></div>
                        <div class="admin-card-title">סנכרון מערכות</div>
                        <div class="admin-card-desc">סנכרון מלא בין כל המערכות והפלטפורמות</div>
                    </div>
                    
                    <div class="admin-card" onclick="window.open('/', '_blank')">
                        <div class="admin-icon"><i class="fas fa-eye"></i></div>
                        <div class="admin-card-title">צפייה באתר</div>
                        <div class="admin-card-desc">עבור לדף הראשי לצפייה במשרות</div>
                    </div>
                </div>
            </section>
            
            <!-- רשימת משרות -->
            <section class="jobs-list-section">
                <h2 class="admin-title">
                    <i class="fas fa-briefcase"></i>
                    ניהול משרות מתקדם
                </h2>
                
                <div class="search-filters">
                    <input type="text" class="form-control" id="searchJobsInput" placeholder="חיפוש חופשי...">
                    
                    <select class="form-control" id="categoryFilterAdmin">
                        <option value="">כל הקטגוריות</option>
                    </select>
                    
                    <select class="form-control" id="statusFilterAdmin">
                        <option value="">כל הסטטוסים</option>
                        <option value="פעיל">פעיל</option>
                        <option value="לא פעיל">לא פעיל</option>
                    </select>

                    <select class="form-control" id="featuredFilterAdmin">
                        <option value="">הכל</option>
                        <option value="true">מומלצות בלבד</option>
                        <option value="false">רגילות בלבד</option>
                    </select>
                </div>
                
                <div class="filter-buttons">
                    <button class="btn" onclick="filterJobsList()">
                        <i class="fas fa-search"></i> חיפוש
                    </button>
                    <button class="btn btn-secondary" onclick="clearJobsFilters()">
                        <i class="fas fa-eraser"></i> נקה
                    </button>
                    <button class="btn" onclick="openBulkModal()">
                        <i class="fas fa-check-square"></i> פעולות מרובות
                    </button>
                </div>
                
                <div class="table-container">
                    <table class="jobs-table" id="jobsTable">
                        <thead>
                            <tr>
                                <th style="width: 50px;">
                                    <input type="checkbox" id="selectAllJobs" onchange="toggleSelectAll()">
                                </th>
                                <th style="width: 80px;">מס' משרה</th>
                                <th>כותרת</th>
                                <th>חברה</th>
                                <th>קטגוריה</th>
                                <th>מיקום</th>
                                <th style="width: 80px;">סטטוס</th>
                                <th style="width: 80px;">מומלצת</th>
                                <th style="width: 220px;">פעולות</th>
                            </tr>
                        </thead>
                        <tbody id="jobsTableBody">
                            <!-- Will be populated by JavaScript -->
                        </tbody>
                    </table>
                </div>
                
                <div class="pagination" id="jobsPagination">
                    <!-- Will be populated by JavaScript -->
                </div>
            </section>
        </main>

        <!-- מודל ייבוא משרות מתקדם -->
        <div id="import-modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="modal-title">
                        <i class="fas fa-file-import"></i>
                        ייבא משרות מתקדם
                    </h3>
                    <span class="close" onclick="closeImportModal()">&times;</span>
                </div>
                
                <div class="import-section">
                    <p style="font-size: 1.1rem; margin-bottom: 20px;">העלה קובץ CSV או JSON עם רשימת המשרות שלך</p>
                    <p style="color: #F69898; font-weight: bold;">המערכת תזהה אוטומטית את השדות ותציע מיפוי אינטליגנטי</p>
                    
                    <div class="file-upload" onclick="document.getElementById('file-input').click()">
                        <div class="file-upload-icon">📁</div>
                        <p style="font-size: 1.2rem; font-weight: bold; margin-bottom: 10px;">לחץ כאן להעלאת קובץ</p>
                        <p>תומך בקבצי CSV, JSON ו-Excel</p>
                        <p style="color: #F69898; margin-top: 10px;">גרור ושחרר קובץ כאן</p>
                    </div>
                    
                    <input type="file" id="file-input" accept=".csv,.json,.xlsx,.xls" style="display: none;" onchange="handleFileUpload(event)">
                    
                    <div style="background: #2a2a2a; padding: 20px; border-radius: 10px; margin-top:20px;">
                        <h4 style="color: #F69898; margin-bottom: 15px;">
                            <i class="fas fa-info-circle"></i>
                            מידע חשוב
                        </h4>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px;">
                            <div>
                                <p><strong>פורמטים נתמכים:</strong></p>
                                <ul style="margin-right: 20px; color: #ccc;">
                                    <li>CSV עם כותרות</li>
                                    <li>JSON מערך אובייקטים</li>
                                    <li>Excel (.xlsx, .xls)</li>
                                </ul>
                            </div>
                            <div>
                                <p><strong>שדות נתמכים:</strong></p>
                                <ul style="margin-right: 20px; color: #ccc;">
                                    <li>מספר משרה, כותרת, חברה</li>
                                    <li>קטגוריה, עיר, אזור</li>
                                    <li>תיאור, דרישות, סטטוס</li>
                                </ul>
                            </div>
                        </div>
                        
                        <div style="margin-top: 20px; text-align: center;">
                            <button class="btn btn-secondary" onclick="downloadAdvancedTemplate()">
                                <i class="fas fa-download"></i>
                                הורד תבנית מתקדמת
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- מודל מיפוי כותרות מתקדם -->
        <div id="mapping-modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="modal-title">
                        <i class="fas fa-map"></i>
                        מיפוי שדות אינטליגנטי
                    </h3>
                    <span class="close" onclick="closeMappingModal()">&times;</span>
                </div>
                
                <div style="padding: 2rem;">
                    <div id="mapping-preview" style="background: #2a2a2a; padding: 15px; border-radius: 10px; margin-bottom: 20px;">
                        <!-- יתמלא דינמית -->
                    </div>
                    
                    <div id="mapping-container">
                        <!-- יתמלא באופן דינמי -->
                    </div>
                    
                    <div style="background: linear-gradient(135deg, rgba(139,92,246,0.1), rgba(168,85,247,0.1)); padding: 20px; border-radius: 10px; margin: 20px 0; border: 2px solid #8B5CF6;">
                        <h4 style="color: #8B5CF6; margin-bottom: 10px;">
                            <i class="fas fa-star"></i>
                            הגדרות מתקדמות
                        </h4>
                        <div style="display: flex; gap: 20px; align-items: center; flex-wrap: wrap;">
                            <label style="display: flex; align-items: center; gap: 8px;">
                                <input type="checkbox" id="setAllFeatured" style="transform: scale(1.2);">
                                <span>סמן הכל כמשרות מומלצות</span>
                            </label>
                            <label style="display: flex; align-items: center; gap: 8px;">
                                <input type="checkbox" id="autoActivate" checked style="transform: scale(1.2);">
                                <span>הפעל אוטומטית את כל המשרות</span>
                            </label>
                        </div>
                    </div>
                    
                    <div class="form-buttons">
                        <button class="btn btn-secondary" onclick="closeMappingModal()">
                            <i class="fas fa-times"></i> ביטול
                        </button>
                        <button class="btn" onclick="applyMapping()">
                            <i class="fas fa-check"></i> ייבא משרות
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- מודל הוספת/עריכת משרה מתקדם -->
        <div id="job-edit-modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 id="edit-modal-title" class="modal-title">
                        <i class="fas fa-plus"></i>
                        הוספת משרה חדשה
                    </h3>
                    <span class="close" onclick="closeEditModal()">&times;</span>
                </div>
                
                <form id="job-edit-form" onsubmit="return saveJob(event)">
                    <input type="hidden" id="edit-job-id">
                    
                    <div class="form-grid">
                        <div class="form-group">
                            <label class="form-label">מספר משרה</label>
                            <input type="text" id="edit-job-number" class="form-input" placeholder="יוגדר אוטומטי אם ריק">
                            <div class="form-help">מספר ייחודי לזיהוי המשרה</div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">כותרת משרה <span class="form-required">*</span></label>
                            <input type="text" id="edit-job-title" class="form-input" required placeholder="למשל: מפתח/ת Full Stack">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">חברה <span class="form-required">*</span></label>
                            <input type="text" id="edit-job-company" class="form-input" required placeholder="שם החברה המגייסת">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">קטגוריה</label>
                            <select id="edit-job-category" class="form-input">
                                <option value="מזון ומסעדנות">מזון ומסעדנות</option>
                                <option value="חינוך והוראה">חינוך והוראה</option>
                                <option value="פיתוח ותוכנה">פיתוח ותוכנה</option>
                                <option value="מחשבים ורשתות תקשורת">מחשבים ורשתות</option>
                                <option value="עולם הרכבים והליסינג">רכבים וליסינג</option>
                                <option value="שיווק ומכירות">שיווק ומכירות</option>
                                <option value="בריאות ורפואה">בריאות ורפואה</option>
                                <option value="מנהל ואדמיניסטרציה">מנהל ואדמיניסטרציה</option>
                                <option value="אחר">אחר</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">עיר <span class="form-required">*</span></label>
                            <input type="text" id="edit-job-city" class="form-input" required placeholder="עיר המשרה">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">אזור <span class="form-required">*</span></label>
                            <select id="edit-job-region" class="form-input" required>
                                <option value="מרכז">מרכז</option>
                                <option value="צפון">צפון</option>
                                <option value="חיפה קריות והצפון">חיפה קריות והצפון</option>
                                <option value="ירושלים והסביבה">ירושלים והסביבה</option>
                                <option value="דרום">דרום</option>
                                <option value="שרון">שרון</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">סוג משרה</label>
                            <select id="edit-job-type" class="form-input">
                                <option value="משרה מלאה">משרה מלאה</option>
                                <option value="משרה חלקית">משרה חלקית</option>
                                <option value="פרילנס">פרילנס</option>
                                <option value="התמחות">התמחות</option>
                                <option value="זמני">זמני</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">סטטוס</label>
                            <select id="edit-job-status" class="form-input">
                                <option value="פעיל">פעיל</option>
                                <option value="לא פעיל">לא פעיל</option>
                            </select>
                        </div>
                    </div>
                    
                    <!-- הגדרה כמשרה מומלצת -->
                    <div style="padding: 0 2rem;">
                        <div class="featured-toggle" id="featuredToggleContainer">
                            <div class="toggle-switch" id="featuredToggle" onclick="toggleFeatured()">
                            </div>
                            <div>
                                <strong style="color: #8B5CF6;">משרה מומלצת</strong>
                                <div style="font-size: 0.9rem; color: #ccc;">משרות מומלצות מופיעות ראשונות באתר עם סימון מיוחד</div>
                            </div>
                        </div>
                    </div>
                    
                    <div style="padding: 0 2rem;">
                        <div class="form-group">
                            <label class="form-label">תיאור המשרה <span class="form-required">*</span></label>
                            <textarea id="edit-job-description" class="form-input" rows="6" required placeholder="תאר את המשרה, התפקיד והאחריות הכלולים..."></textarea>
                            <div class="form-help">תיאור מפורט יעזור למועמדים להבין את התפקיד</div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">דרישות התפקיד</label>
                            <textarea id="edit-job-requirements" class="form-input" rows="5" placeholder="רשום את הדרישות והכישורים הנדרשים..."></textarea>
                            <div class="form-help">הפרד בין דרישות שונות באמצעות ירידת שורה</div>
                        </div>
                    </div>
                    
                    <div class="form-buttons">
                        <button type="button" class="btn btn-secondary" onclick="closeEditModal()">
                            <i class="fas fa-times"></i> ביטול
                        </button>
                        <button type="submit" class="btn">
                            <i class="fas fa-save"></i> שמור משרה
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- מודל פעולות מרובות -->
        <div id="bulk-modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="modal-title">
                        <i class="fas fa-list-check"></i>
                        פעולות מרובות
                    </h3>
                    <span class="close" onclick="closeBulkModal()">&times;</span>
                </div>
                
                <div style="padding: 2rem;">
                    <p style="margin-bottom: 20px; font-size: 1.1rem;">
                        נבחרו <span id="selectedCount" style="color: #F69898; font-weight: bold;">0</span> משרות
                    </p>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                        <button class="btn" onclick="bulkAction('activate')">
                            <i class="fas fa-check-circle"></i>
                            הפעל הכל
                        </button>
                        <button class="btn btn-secondary" onclick="bulkAction('deactivate')">
                            <i class="fas fa-times-circle"></i>
                            השבת הכל
                        </button>
                        <button class="btn btn-featured" onclick="bulkAction('feature')">
                            <i class="fas fa-star"></i>
                            סמן כמומלצות
                        </button>
                        <button class="btn btn-secondary" onclick="bulkAction('unfeature')">
                            <i class="fas fa-star-o"></i>
                            בטל המלצה
                        </button>
                        <button class="btn btn-delete" onclick="bulkAction('delete')">
                            <i class="fas fa-trash"></i>
                            מחק הכל
                        </button>
                    </div>
                    
                    <div style="margin-top: 30px; text-align: center;">
                        <button class="btn btn-secondary" onclick="closeBulkModal()">
                            <i class="fas fa-times"></i> סגור
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- כותרת תחתונה -->
        <footer class="footer">
            <div class="container">
                <div style="text-align: center; margin-bottom: 30px;">
                    <h2 class="text-logo" style="font-size: 2.5rem;">מה יש פה?</h2>
                    <p style="font-size: 1.2rem; margin-bottom: 15px; color: #cccccc;">מערכת ניהול מתקדמת ללוח משרות</p>
                </div>
                
                <div class="footer-links">
                    <a href="/" class="footer-link">דף הבית</a>
                    <a href="#" class="footer-link">ניהול מתקדם</a>
                    <a href="/#search" class="footer-link">חיפוש משרות</a>
                    <a href="/#contact" class="footer-link">צור קשר</a>
                </div>
                
                <p class="copyright">© 2025 מה יש פה? - מערכת ניהול מתקדמת</p>
            </div>
        </footer>
    </div>

    <script>
        // כל הקוד JavaScript יבוא בארטיפקט הבא...
        console.log('מערכת ניהול בטעינה...');
    </script>
</body>
<script>
        // משתנים גלובליים מתקדמים
        let jobs = [];
        let filteredJobs = [];
        let currentPage = 1;
        const jobsPerPage = 15;
        let csvData = null;
        let csvHeaders = [];
        let isFiltered = false;
        let selectedJobs = new Set();
        let featuredJobId = null;
        let syncInterval = null;

        // מיפוי שדות המערכת
        const systemFields = {
            'jobNumber': 'מספר משרה',
            'title': 'כותרת',
            'company': 'חברה', 
            'category': 'קטגוריה',
            'city': 'עיר',
            'region': 'אזור',
            'jobType': 'סוג משרה',
            'status': 'סטטוס',
            'description': 'תיאור',
            'requirements': 'דרישות',
            'featured': 'מומלצת'
        };

        // קטגוריות ברירת מחדל
        const defaultCategories = [
            'מזון ומסעדנות', 'חינוך והוראה', 'פיתוח ותוכנה',
            'מחשבים ורשתות תקשורת', 'עולם הרכבים והליסינג',
            'שיווק ומכירות', 'בריאות ורפואה', 'מנהל ואדמיניסטרציה', 'אחר'
        ];

        // פונקציות אתחול
        function showLoginForm() {
            document.getElementById('adminLoginSection').style.display = 'flex';
        }

        function checkAdminPassword() {
            const password = document.getElementById('adminPassword').value;
            const correctPassword = "yarin080708";
            
            if (password === correctPassword) {
                document.getElementById('adminLoginSection').style.display = 'none';
                document.getElementById('adminContentSection').style.display = 'block';
                document.getElementById('backToSite').style.display = 'block';
                sessionStorage.setItem('adminAuthenticated', 'true');
                initializeAdminSystem();
            } else {
                document.getElementById('adminErrorMessage').style.display = 'block';
                setTimeout(() => {
                    document.getElementById('adminErrorMessage').style.display = 'none';
                }, 3000);
            }
        }

        // אתחול מערכת הניהול המתקדמת
        function initializeAdminSystem() {
            showNotification('מערכת הניהול נטענת...', 'warning');
            showLoading();
            
            loadJobsAdvanced()
                .then(() => {
                    updateStatistics();
                    startSyncMonitoring();
                    showNotification('מערכת הניהול מוכנה לשימוש!', 'success');
                })
                .catch(error => {
                    console.error('שגיאה באתחול:', error);
                    showNotification('שגיאה באתחול המערכת', 'error');
                })
                .finally(() => {
                    hideLoading();
                });
        }

        // טעינת משרות מתקדמת עם סנכרון
        async function loadJobsAdvanced() {
            console.log('🚀 מתחיל טעינה מתקדמת של משרות...');
            
            // בדיקת נתונים מקומיים
            const localJobs = localStorage.getItem('jobs');
            const localDate = localStorage.getItem('jobs_last_updated');
            
            if (localJobs) {
                try {
                    jobs = JSON.parse(localJobs);
                    jobs = jobs.map(job => ({
                        ...job,
                        featured: job.featured || false,
                        jobType: job.jobType || 'משרה מלאה'
                    }));
                    
                    console.log('✅ נטענו', jobs.length, 'משרות מהאחסון המקומי');
                    updateAllDisplays();
                    updateSyncStatus('localStorage', true, localDate);
                } catch (error) {
                    console.error('❌ שגיאה בטעינה מהאחסון המקומי:', error);
                }
            }

            // בדיקת GitHub במקביל
            try {
const response = await fetch('https://raw.githubusercontent.com/YOUR-USERNAME/YOUR-REPO/main/jobs.json');
                if (response.ok) {
                    const githubJobs = await response.json();
                    updateSyncStatus('github', true);
                    
                    // השוואה ועדכון במידת הצורך
                    if (!localJobs || githubJobs.length !== jobs.length) {
                        console.log('🔄 מעדכן מ-GitHub...');
                        jobs = githubJobs.map(job => ({
                            ...job,
                            featured: job.featured || false,
                            jobType: job.jobType || 'משרה מלאה'
                        }));
                        
                        saveJobsToLocal();
                        updateAllDisplays();
                        showNotification('משרות עודכנו מ-GitHub', 'success');
                    }
                } else {
                    throw new Error('שגיאה בטעינה מ-GitHub');
                }
            } catch (error) {
                console.warn('⚠️ לא ניתן לטעון מ-GitHub:', error.message);
                updateSyncStatus('github', false);
            }

            // עדכון זמן בדיקה אחרון
            localStorage.setItem('last_sync_check', new Date().toISOString());
        }

        // שמירת משרות מתקדמת
        function saveJobsAdvanced() {
            try {
                // שמירה מקומית
                saveJobsToLocal();
                
                // סנכרון עם האתר הראשי
                syncWithMainWebsite();
                
                // עדכון תצוגה
                updateAllDisplays();
                
                showNotification('המשרות נשמרו ומסונכרנות בהצלחה!', 'success');
                
            } catch (error) {
                console.error('❌ שגיאה בשמירה:', error);
                showNotification('שגיאה בשמירת המשרות', 'error');
            }
        }

        function saveJobsToLocal() {
            localStorage.setItem('jobs', JSON.stringify(jobs));
            localStorage.setItem('jobs_last_updated', new Date().toISOString());
            updateSyncStatus('localStorage', true);
        }

        // סנכרון עם האתר הראשי
        function syncWithMainWebsite() {
            try {
                // שמירה לאתר הראשי - השתמש בשמות הנכונים
                localStorage.setItem('website_jobs', JSON.stringify(jobs));
                localStorage.setItem('website_jobs_updated', new Date().toISOString());
                localStorage.setItem('website_jobs_source', 'Admin System');
                
                updateSyncStatus('website', true);
                console.log('✅ סונכרן עם האתר הראשי');
            } catch (error) {
                console.error('❌ שגיאה בסנכרון עם האתר:', error);
                updateSyncStatus('website', false);
            }
        }

        // עדכון כל התצוגות
        function updateAllDisplays() {
            if (isFiltered) {
                applyFilters();
            } else {
                filteredJobs = [...jobs];
            }
            
            displayJobsAdvanced();
            updateCategoryFilters();
            updateStatistics();
        }

        // הצגת משרות מתקדמת
        function displayJobsAdvanced() {
            const tableBody = document.getElementById('jobsTableBody');
            tableBody.innerHTML = '';
            
            const jobsToDisplay = filteredJobs;
            
            if (jobsToDisplay.length === 0) {
                const row = document.createElement('tr');
                row.innerHTML = `<td colspan="9" style="text-align: center; padding: 3rem; color: #aaa;">
                    ${isFiltered ? 
                        'לא נמצאו משרות התואמות את הסינון<br><button class="btn btn-secondary" onclick="clearJobsFilters()">נקה סינון</button>' : 
                        'אין משרות להצגה<br><button class="btn" onclick="openAddJobModal()">הוסף משרה ראשונה</button>'
                    }
                </td>`;
                tableBody.appendChild(row);
                document.getElementById('jobsPagination').innerHTML = '';
                return;
            }
            
            const totalPages = Math.ceil(jobsToDisplay.length / jobsPerPage);
            currentPage = Math.min(currentPage, totalPages);
            currentPage = Math.max(currentPage, 1);
            
            const startIndex = (currentPage - 1) * jobsPerPage;
            const endIndex = Math.min(startIndex + jobsPerPage, jobsToDisplay.length);
            const pageJobs = jobsToDisplay.slice(startIndex, endIndex);
            
            // הוספת שורת מידע על הסינון
            if (isFiltered) {
                const infoRow = document.createElement('tr');
                infoRow.innerHTML = `
                    <td colspan="9" style="text-align: center; padding: 15px; background: rgba(246, 152, 152, 0.1); border: 2px solid #F69898;">
                        <i class="fas fa-filter"></i>
                        מציג ${jobsToDisplay.length} מתוך ${jobs.length} משרות
                        <button class="btn btn-sm btn-secondary" style="margin-right: 15px;" onclick="clearJobsFilters()">
                            <i class="fas fa-times"></i> נקה סינון
                        </button>
                    </td>
                `;
                tableBody.appendChild(infoRow);
            }
            
            pageJobs.forEach((job, index) => {
                const actualIndex = startIndex + index;
                const originalIndex = jobs.findIndex(j => 
                    j.jobNumber === job.jobNumber && 
                    j.title === job.title && 
                    j.company === job.company
                );
                
                const row = document.createElement('tr');
                if (job.featured) {
                    row.classList.add('featured-row');
                }
                
                const isSelected = selectedJobs.has(originalIndex);
                
                row.innerHTML = `
                    <td>
                        <input type="checkbox" ${isSelected ? 'checked' : ''} 
                               onchange="toggleJobSelection(${originalIndex})">
                    </td>
                    <td>${job.jobNumber || 'אוטו'}</td>
                    <td>
                        ${job.featured ? '<span class="featured-badge">⭐ מומלצת</span>' : ''}
                        ${job.title || '-'}
                    </td>
                    <td>${job.company || '-'}</td>
                    <td>${job.category || 'אחר'}</td>
                    <td>${job.city ? job.city + ', ' + (job.region || 'מרכז') : job.region || 'מרכז'}</td>
                    <td class="${job.status === 'לא פעיל' ? 'status-inactive' : 'status-active'}">
                        ${job.status || 'פעיל'}
                    </td>
                    <td>
                        <button class="btn btn-sm ${job.featured ? 'btn-featured' : 'btn-secondary'}" 
                                onclick="toggleJobFeatured(${originalIndex})" 
                                title="${job.featured ? 'בטל המלצה' : 'סמן כמומלצת'}">
                            <i class="fas ${job.featured ? 'fa-star' : 'fa-star-o'}"></i>
                        </button>
                    </td>
                    <td>
                        <div class="action-buttons">
                            <button class="btn btn-sm btn-view" onclick="viewJobAdvanced(${originalIndex})" title="הצג פרטים">
                                <i class="fas fa-eye"></i>
                            </button>
                            <button class="btn btn-sm btn-edit" onclick="editJobAdvanced(${originalIndex})" title="ערוך">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="btn btn-sm btn-delete" onclick="deleteJobAdvanced(${originalIndex})" title="מחק">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </td>
                `;
                
                tableBody.appendChild(row);
            });
            
            updatePaginationAdvanced(totalPages);
        }

        // עדכון מניית דפים מתקדם
        function updatePaginationAdvanced(totalPages) {
            const pagination = document.getElementById('jobsPagination');
            pagination.innerHTML = '';
            
            if (totalPages <= 1) return;
            
            // כפתור עמוד קודם
            if (currentPage > 1) {
                const prevBtn = document.createElement('div');
                prevBtn.className = 'page-item';
                prevBtn.innerHTML = '<i class="fas fa-chevron-right"></i>';
                prevBtn.onclick = () => {
                    currentPage--;
                    displayJobsAdvanced();
                };
                pagination.appendChild(prevBtn);
            }
            
            // מספרי עמודים
            const startPage = Math.max(1, currentPage - 2);
            const endPage = Math.min(totalPages, currentPage + 2);
            
            if (startPage > 1) {
                const firstBtn = document.createElement('div');
                firstBtn.className = 'page-item';
                firstBtn.textContent = '1';
                firstBtn.onclick = () => {
                    currentPage = 1;
                    displayJobsAdvanced();
                };
                pagination.appendChild(firstBtn);
                
                if (startPage > 2) {
                    const dots = document.createElement('div');
                    dots.className = 'page-item';
                    dots.textContent = '...';
                    dots.style.cursor = 'default';
                    pagination.appendChild(dots);
                }
            }
            
            for (let i = startPage; i <= endPage; i++) {
                const pageBtn = document.createElement('div');
                pageBtn.className = 'page-item' + (i === currentPage ? ' active' : '');
                pageBtn.textContent = i;
                pageBtn.onclick = () => {
                    currentPage = i;
                    displayJobsAdvanced();
                };
                pagination.appendChild(pageBtn);
            }

            if (endPage < totalPages) {
                if (endPage < totalPages - 1) {
                    const dots = document.createElement('div');
                    dots.className = 'page-item';
                    dots.textContent = '...';
                    dots.style.cursor = 'default';
                    pagination.appendChild(dots);
                }
                
                const lastBtn = document.createElement('div');
                lastBtn.className = 'page-item';
                lastBtn.textContent = totalPages;
                lastBtn.onclick = () => {
                    currentPage = totalPages;
                    displayJobsAdvanced();
                };
                pagination.appendChild(lastBtn);
            }
            
            // כפתור עמוד הבא
            if (currentPage < totalPages) {
                const nextBtn = document.createElement('div');
                nextBtn.className = 'page-item';
                nextBtn.innerHTML = '<i class="fas fa-chevron-left"></i>';
                nextBtn.onclick = () => {
                    currentPage++;
                    displayJobsAdvanced();
                };
                pagination.appendChild(nextBtn);
            }
        }

        // עדכון סטטיסטיקות
        function updateStatistics() {
            const total = jobs.length;
            const active = jobs.filter(job => job.status === 'פעיל').length;
            const featured = jobs.filter(job => job.featured).length;
            const categories = [...new Set(jobs.map(job => job.category).filter(Boolean))].length;
            
            document.getElementById('totalJobsCount').textContent = total;
            document.getElementById('activeJobsCount').textContent = active;
            document.getElementById('featuredJobsCount').textContent = featured;
            document.getElementById('categoriesCount').textContent = categories;
        }

        // עדכון מסנני קטגוריות
        function updateCategoryFilters() {
            const categoryFilter = document.getElementById('categoryFilterAdmin');
            const currentValue = categoryFilter.value;
            
            const categories = [...new Set(jobs.map(job => job.category).filter(Boolean))].sort();
            
            categoryFilter.innerHTML = '<option value="">כל הקטגוריות</option>';
            categories.forEach(category => {
                const option = document.createElement('option');
                option.value = category;
                option.textContent = category;
                categoryFilter.appendChild(option);
            });
            
            categoryFilter.value = currentValue;
        }

        // ניהול בחירות משרות
        function toggleJobSelection(index) {
            if (selectedJobs.has(index)) {
                selectedJobs.delete(index);
            } else {
                selectedJobs.add(index);
            }
            updateSelectAllCheckbox();
        }

        function toggleSelectAll() {
            const selectAllCheckbox = document.getElementById('selectAllJobs');
            const currentJobs = filteredJobs;
            
            if (selectAllCheckbox.checked) {
                currentJobs.forEach((job, index) => {
                    const originalIndex = jobs.findIndex(j => 
                        j.jobNumber === job.jobNumber && 
                        j.title === job.title && 
                        j.company === job.company
                    );
                    if (originalIndex !== -1) {
                        selectedJobs.add(originalIndex);
                    }
                });
            } else {
                selectedJobs.clear();
            }
            
            displayJobsAdvanced();
        }

        function updateSelectAllCheckbox() {
            const selectAllCheckbox = document.getElementById('selectAllJobs');
            const currentJobsCount = filteredJobs.length;
            const selectedCurrentJobs = filteredJobs.filter((job, index) => {
                const originalIndex = jobs.findIndex(j => 
                    j.jobNumber === job.jobNumber && 
                    j.title === job.title && 
                    j.company === job.company
                );
                return selectedJobs.has(originalIndex);
            }).length;
            
            selectAllCheckbox.checked = currentJobsCount > 0 && selectedCurrentJobs === currentJobsCount;
            selectAllCheckbox.indeterminate = selectedCurrentJobs > 0 && selectedCurrentJobs < currentJobsCount;
        }

        // פונקציות מתקדמות למשרות
        function toggleJobFeatured(index) {
            jobs[index].featured = !jobs[index].featured;
            saveJobsAdvanced();
            showNotification(
                jobs[index].featured ? 'המשרה סומנה כמומלצת' : 'ההמלצה בוטלה',
                'success'
            );
        }

        function editJobAdvanced(index) {
            const job = jobs[index];
            
            document.getElementById('edit-modal-title').innerHTML = '<i class="fas fa-edit"></i> עריכת משרה';
            document.getElementById('edit-job-id').value = index;
            document.getElementById('edit-job-number').value = job.jobNumber || '';
            document.getElementById('edit-job-title').value = job.title || '';
            document.getElementById('edit-job-company').value = job.company || '';
            document.getElementById('edit-job-category').value = job.category || 'אחר';
            document.getElementById('edit-job-city').value = job.city || '';
            document.getElementById('edit-job-region').value = job.region || 'מרכז';
            document.getElementById('edit-job-type').value = job.jobType || 'משרה מלאה';
            document.getElementById('edit-job-status').value = job.status || 'פעיל';
            document.getElementById('edit-job-description').value = job.description || '';
            document.getElementById('edit-job-requirements').value = job.requirements || '';
            
            // הגדרת מצב המשרה המומלצת
            featuredJobId = job.featured;
            updateFeaturedToggle();
            
            document.getElementById('job-edit-modal').style.display = 'block';
        }

        function viewJobAdvanced(index) {
            const job = jobs[index];
            let details = '';
            
            details += `🏢 חברה: ${job.company || 'לא הוגדר'}\n`;
            details += `📋 כותרת: ${job.title || 'לא הוגדר'}\n`;
            details += `🔢 מספר משרה: ${job.jobNumber || 'אוטומטי'}\n`;
            details += `📂 קטגוריה: ${job.category || 'אחר'}\n`;
            details += `📍 מיקום: ${job.city ? job.city + ', ' + (job.region || 'מרכז') : job.region || 'מרכז'}\n`;
            details += `⏰ סוג משרה: ${job.jobType || 'משרה מלאה'}\n`;
            details += `📊 סטטוס: ${job.status || 'פעיל'}\n`;
            details += `⭐ מומלצת: ${job.featured ? 'כן' : 'לא'}\n\n`;
            details += `📝 תיאור המשרה:\n${job.description || '(אין תיאור)'}\n\n`;
            details += `📋 דרישות התפקיד:\n${job.requirements || '(אין דרישות מיוחדות)'}`;
            
            alert(details);
        }

        function deleteJobAdvanced(index) {
            const job = jobs[index];
            if (confirm(`האם אתה בטוח שברצונך למחוק את המשרה:\n"${job.title}" ב-${job.company}?`)) {
                jobs.splice(index, 1);
                selectedJobs.delete(index);
                
                // עדכון אינדקסים של משרות נבחרות
                const newSelectedJobs = new Set();
                selectedJobs.forEach(selectedIndex => {
                    if (selectedIndex > index) {
                        newSelectedJobs.add(selectedIndex - 1);
                    } else if (selectedIndex < index) {
                        newSelectedJobs.add(selectedIndex);
                    }
                });
                selectedJobs = newSelectedJobs;
                
                saveJobsAdvanced();
                showNotification('המשרה נמחקה בהצלחה', 'success');
            }
        }

        // פונקציות מודל
        function openAddJobModal() {
            document.getElementById('edit-modal-title').innerHTML = '<i class="fas fa-plus"></i> הוספת משרה חדשה';
            document.getElementById('job-edit-form').reset();
            document.getElementById('edit-job-id').value = '';
            
            // איפוס מצב המשרה המומלצת
            featuredJobId = false;
            updateFeaturedToggle();
            
            document.getElementById('job-edit-modal').style.display = 'block';
        }

        function closeEditModal() {
            document.getElementById('job-edit-modal').style.display = 'none';
        }

        function saveJob(event) {
            event.preventDefault();
            
            const id = document.getElementById('edit-job-id').value;
            const job = {
                jobNumber: document.getElementById('edit-job-number').value || generateJobNumber(),
                title: document.getElementById('edit-job-title').value,
                company: document.getElementById('edit-job-company').value,
                category: document.getElementById('edit-job-category').value,
                city: document.getElementById('edit-job-city').value,
                region: document.getElementById('edit-job-region').value,
                jobType: document.getElementById('edit-job-type').value,
                status: document.getElementById('edit-job-status').value,
                description: document.getElementById('edit-job-description').value,
                requirements: document.getElementById('edit-job-requirements').value,
                featured: featuredJobId
            };
            
            if (id === '') {
                // הוספת משרה חדשה
                jobs.push(job);
                showNotification('משרה חדשה נוספה בהצלחה!', 'success');
            } else {
                // עדכון משרה קיימת
                jobs[parseInt(id)] = job;
                showNotification('המשרה עודכנה בהצלחה!', 'success');
            }
            
            saveJobsAdvanced();
            closeEditModal();
            return false;
        }

        // יצירת מספר משרה אוטומטי
        function generateJobNumber() {
            const existing = jobs.map(job => job.jobNumber).filter(Boolean);
            const numbers = existing.map(num => parseInt(num.replace(/\D/g, ''))).filter(num => !isNaN(num));
            const maxNumber = numbers.length > 0 ? Math.max(...numbers) : 0;
            return `JOB${(maxNumber + 1).toString().padStart(3, '0')}`;
        }

        // טוגל למשרה מומלצת
        function toggleFeatured() {
            featuredJobId = !featuredJobId;
            updateFeaturedToggle();
        }

        function updateFeaturedToggle() {
            const toggle = document.getElementById('featuredToggle');
            if (featuredJobId) {
                toggle.classList.add('active');
            } else {
                toggle.classList.remove('active');
            }
        }

        // סינון מתקדם
        function filterJobsList() {
            applyFilters();
            currentPage = 1;
            displayJobsAdvanced();
        }

        function applyFilters() {
            const searchText = document.getElementById('searchJobsInput').value.toLowerCase();
            const categoryFilter = document.getElementById('categoryFilterAdmin').value;
            const statusFilter = document.getElementById('statusFilterAdmin').value;
            const featuredFilter = document.getElementById('featuredFilterAdmin').value;
            
            isFiltered = searchText || categoryFilter || statusFilter || featuredFilter;
            
            filteredJobs = jobs.filter(job => {
                const matchesSearch = !searchText || 
                    (job.title && job.title.toLowerCase().includes(searchText)) ||
                    (job.company && job.company.toLowerCase().includes(searchText)) ||
                    (job.description && job.description.toLowerCase().includes(searchText)) ||
                    (job.jobNumber && job.jobNumber.toString().includes(searchText)) ||
                    (job.city && job.city.toLowerCase().includes(searchText));
                
                const matchesCategory = !categoryFilter || job.category === categoryFilter;
                const matchesStatus = !statusFilter || job.status === statusFilter;
                const matchesFeatured = !featuredFilter || 
                    (featuredFilter === 'true' && job.featured) ||
                    (featuredFilter === 'false' && !job.featured);
                
                return matchesSearch && matchesCategory && matchesStatus && matchesFeatured;
            });
        }

        function clearJobsFilters() {
            document.getElementById('searchJobsInput').value = '';
            document.getElementById('categoryFilterAdmin').value = '';
            document.getElementById('statusFilterAdmin').value = '';
            document.getElementById('featuredFilterAdmin').value = '';
            
            isFiltered = false;
            filteredJobs = [...jobs];
            selectedJobs.clear();
            currentPage = 1;
            displayJobsAdvanced();
        }

        // פעולות מרובות
        function openBulkModal() {
            if (selectedJobs.size === 0) {
                showNotification('יש לבחור לפחות משרה אחת', 'warning');
                return;
            }
            
            document.getElementById('selectedCount').textContent = selectedJobs.size;
            document.getElementById('bulk-modal').style.display = 'block';
        }

        function closeBulkModal() {
            document.getElementById('bulk-modal').style.display = 'none';
        }

        function bulkAction(action) {
            if (selectedJobs.size === 0) {
                showNotification('לא נבחרו משרות', 'warning');
                return;
            }
            
            let message = '';
            let confirmMessage = '';
            
            switch (action) {
                case 'activate':
                    selectedJobs.forEach(index => {
                        jobs[index].status = 'פעיל';
                    });
                    message = `${selectedJobs.size} משרות הופעלו`;
                    break;
                    
                case 'deactivate':
                    selectedJobs.forEach(index => {
                        jobs[index].status = 'לא פעיל';
                    });
                    message = `${selectedJobs.size} משרות הושבתו`;
                    break;
                    
                case 'feature':
                    selectedJobs.forEach(index => {
                        jobs[index].featured = true;
                    });
                    message = `${selectedJobs.size} משרות סומנו כמומלצות`;
                    break;
                    
                case 'unfeature':
                    selectedJobs.forEach(index => {
                        jobs[index].featured = false;
                    });
                    message = `${selectedJobs.size} משרות בוטלה המלצתן`;
                    break;
                    
                case 'delete':
                    confirmMessage = `האם אתה בטוח שברצונך למחוק ${selectedJobs.size} משרות?`;
                    if (!confirm(confirmMessage)) {
                        return;
                    }
                    
                    // מחיקה לפי סדר הפוך כדי לא לשבש אינדקסים
                    const sortedIndexes = Array.from(selectedJobs).sort((a, b)=> b - a);
                    sortedIndexes.forEach(index => {
                        jobs.splice(index, 1);
                    });
                    
                    selectedJobs.clear();
                    message = `${sortedIndexes.length} משרות נמחקו`;
                    break;
            }
            
            saveJobsAdvanced();
            closeBulkModal();
            showNotification(message, 'success');
        }

        // ייבוא וייצוא מתקדם
        function openImportModal() {
            document.getElementById('import-modal').style.display = 'block';
        }

        function closeImportModal() {
            document.getElementById('import-modal').style.display = 'none';
            document.getElementById('file-input').value = '';
        }

        function handleFileUpload(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            showLoading();
            console.log('📁 קובץ נבחר:', file.name, file.type);
            
            const reader = new FileReader();
            
            reader.onload = function(e) {
                try {
                    if (file.name.endsWith('.csv')) {
                        parseCSVAdvanced(e.target.result);
                    } else if (file.name.endsWith('.json')) {
                        parseJSONAdvanced(e.target.result);
                    } else if (file.name.endsWith('.xlsx') || file.name.endsWith('.xls')) {
                        parseExcelAdvanced(e.target.result);
                    } else {
                        throw new Error('פורמט קובץ לא נתמך');
                    }
                } catch (error) {
                    console.error('❌ שגיאה בעיבוד הקובץ:', error);
                    showNotification('שגיאה בעיבוד הקובץ: ' + error.message, 'error');
                } finally {
                    hideLoading();
                }
            };
            
            if (file.name.endsWith('.xlsx') || file.name.endsWith('.xls')) {
                reader.readAsArrayBuffer(file);
            } else {
                reader.readAsText(file, 'UTF-8');
            }
        }

        function parseCSVAdvanced(csvText) {
            const lines = csvText.split('\n').filter(line => line.trim());
            if (lines.length < 2) {
                throw new Error('הקובץ חייב להכיל לפחות שורת כותרות ושורה אחת של נתונים');
            }
            
            const headers = parseCSVLine(lines[0]);
            const dataLines = lines.slice(1);
            const data = dataLines.map(line => {
                const values = parseCSVLine(line);
                const row = {};
                headers.forEach((header, index) => {
                    row[header] = values[index] || '';
                });
                return row;
            }).filter(row => Object.values(row).some(val => val.trim()));
            
            openMappingModalAdvanced(headers, data);
        }

        function parseJSONAdvanced(jsonData) {
            const parsedData = JSON.parse(jsonData);
            let dataArray = Array.isArray(parsedData) ? parsedData : [parsedData];
            
            if (dataArray.length === 0) {
                throw new Error('הקובץ JSON ריק או לא מכיל נתונים');
            }
            
            const allKeys = new Set();
            dataArray.forEach(item => {
                if (typeof item === 'object' && item !== null) {
                    Object.keys(item).forEach(key => allKeys.add(key));
                }
            });
            
            const headers = Array.from(allKeys);
            const data = dataArray.map(item => {
                const row = {};
                headers.forEach(header => {
                    row[header] = item[header] || '';
                });
                return row;
            });
            
            openMappingModalAdvanced(headers, data);
        }

        function parseExcelAdvanced(arrayBuffer) {
            // Note: This would require the SheetJS library to be loaded
            showNotification('תמיכה בקבצי Excel תתווסף בגרסה הבאה', 'warning');
        }

        function parseCSVLine(line) {
            const result = [];
            let current = '';
            let inQuotes = false;
            
            for (let i = 0; i < line.length; i++) {
                const char = line[i];
                
                if (char === '"') {
                    inQuotes = !inQuotes;
                } else if (char === ',' && !inQuotes) {
                    result.push(current.trim());
                    current = '';
                } else {
                    current += char;
                }
            }
            
            result.push(current.trim());
            return result;
        }

        // מודל מיפוי מתקדם
        function openMappingModalAdvanced(headers, data) {
            csvHeaders = headers;
            csvData = data;
            
            const container = document.getElementById('mapping-container');
            const preview = document.getElementById('mapping-preview');
            
            // הצגת תצוגה מקדימה
            preview.innerHTML = `
                <h4 style="color: #F69898; margin-bottom: 10px;">
                    <i class="fas fa-eye"></i>
                    תצוגה מקדימה
                </h4>
                <p><strong>נמצאו ${headers.length} עמודות ו-${data.length} שורות נתונים</strong></p>
                <p style="color: #ccc;">עמודות: ${headers.join(', ')}</p>
            `;
            
            container.innerHTML = '';
            
            const mappingGrid = document.createElement('div');
            mappingGrid.style.display = 'grid';
            mappingGrid.style.gridTemplateColumns = 'repeat(auto-fit, minmax(300px, 1fr))';
            mappingGrid.style.gap = '15px';
            
            Object.keys(systemFields).forEach(fieldKey => {
                const mappingItem = document.createElement('div');
                mappingItem.style.background = '#2a2a2a';
                mappingItem.style.padding = '15px';
                mappingItem.style.borderRadius = '10px';
                mappingItem.style.border = '1px solid #444';
                
                // זיהוי אוטומטי של התאמה
                const suggestedHeader = autoDetectMapping(fieldKey, headers);
                
                mappingItem.innerHTML = `
                    <label class="form-label" style="color: #F69898; margin-bottom: 8px;">
                        ${systemFields[fieldKey]}
                        ${['title', 'company', 'city', 'region'].includes(fieldKey) ? ' <span style="color: #F69898;">*</span>' : ''}
                    </label>
                    <select class="form-input" data-field="${fieldKey}">
                        <option value="">-- בחר עמודה מהקובץ --</option>
                        ${headers.map(header => 
                            `<option value="${header}" ${header === suggestedHeader ? 'selected' : ''}>${header}</option>`
                        ).join('')}
                    </select>
                    ${suggestedHeader ? `<div style="color: #28a745; font-size: 0.8rem; margin-top: 4px;">
                        <i class="fas fa-check"></i> זוהה אוטומטית
                    </div>` : ''}
                `;
                
                mappingGrid.appendChild(mappingItem);
            });
            
            container.appendChild(mappingGrid);
            
            closeImportModal();
            document.getElementById('mapping-modal').style.display = 'block';
        }

        // זיהוי אוטומטי של מיפוי
        function autoDetectMapping(fieldKey, headers) {
            const mappings = {
                'jobNumber': ['מספר משרה', 'job number', 'id', 'מספר', 'number'],
                'title': ['כותרת', 'title', 'תפקיד', 'position', 'job title'],
                'company': ['חברה', 'company', 'employer', 'מעסיק'],
                'category': ['קטגוריה', 'category', 'תחום', 'field'],
                'city': ['עיר', 'city', 'מיקום', 'location'],
                'region': ['אזור', 'region', 'area', 'מחוז'],
                'jobType': ['סוג משרה', 'job type', 'type', 'סוג'],
                'status': ['סטטוס', 'status', 'מצב', 'state'],
                'description': ['תיאור', 'description', 'desc', 'פירוט'],
                'requirements': ['דרישות', 'requirements', 'req', 'כישורים'],
                'featured': ['מומלצת', 'featured', 'highlighted', 'מוצגת']
            };
            
            const keywords = mappings[fieldKey] || [];
            
            return headers.find(header => 
                keywords.some(keyword => 
                    header.toLowerCase().includes(keyword.toLowerCase())
                )
            );
        }

        function closeMappingModal() {
            document.getElementById('mapping-modal').style.display = 'none';
            csvData = null;
            csvHeaders = [];
        }

        function applyMapping() {
            const selects = document.querySelectorAll('#mapping-container select');
            const mapping = {};
            
            selects.forEach(select => {
                const field = select.getAttribute('data-field');
                const column = select.value;
                if (column) {
                    mapping[field] = column;
                }
            });
            
            if (!mapping.title && !mapping.company) {
                showNotification('יש למפות לפחות את שדה הכותרת או החברה', 'warning');
                return;
            }
            
            const setAllFeatured = document.getElementById('setAllFeatured').checked;
            const autoActivate = document.getElementById('autoActivate').checked;
            
            const jobsData = csvData.map(row => {
                const job = {};
                Object.keys(mapping).forEach(field => {
                    const column = mapping[field];
                    job[field] = row[column] ? row[column].trim() : '';
                });
                
                // הגדרות ברירת מחדל
                if (!job.status) job.status = autoActivate ? 'פעיל' : 'לא פעיל';
                if (!job.category) job.category = 'אחר';
                if (!job.region) job.region = 'מרכז';
                if (!job.jobType) job.jobType = 'משרה מלאה';
                if (!job.jobNumber) job.jobNumber = generateJobNumber();
                job.featured = setAllFeatured;
                
                return job;
            });
            
            const validJobs = jobsData.filter(job => 
                (job.title && job.title.trim()) || 
                (job.company && job.company.trim())
            );
            
            if (validJobs.length === 0) {
                showNotification('לא נמצאו משרות תקינות לייבוא', 'error');
                return;
            }
            
            const shouldReplace = validJobs.length > 10 ? 
                confirm(`נמצאו ${validJobs.length} משרות לייבוא.\nהאם להחליף את כל המשרות הקיימות?`) :
                !confirm(`נמצאו ${validJobs.length} משרות לייבוא.\nהאם להוסיף אותן למשרות הקיימות?`);
            
            if (shouldReplace) {
                jobs = [...validJobs];
            } else {
                jobs = [...jobs, ...validJobs];
            }
            
            saveJobsAdvanced();
            closeMappingModal();
            
            showNotification(
                `${validJobs.length} משרות יובאו בהצלחה!${setAllFeatured ? ' (כולן מומלצות)' : ''}`,
                'success'
            );
        }

        // ייצוא מתקדם
        function exportJobs() {
            if (jobs.length === 0) {
                showNotification('אין משרות לייצוא', 'warning');
                return;
            }
            
            const dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(jobs, null, 2));
            const downloadAnchorNode = document.createElement('a');
            downloadAnchorNode.setAttribute("href", dataStr);
            downloadAnchorNode.setAttribute("download", `jobs_export_${new Date().toISOString().split('T')[0]}.json`);
            document.body.appendChild(downloadAnchorNode);
            downloadAnchorNode.click();
            downloadAnchorNode.remove();
            
            showNotification('קובץ המשרות יוצא בהצלחה', 'success');
        }

        function exportForGitHub() {
            if (jobs.length === 0) {
                showNotification('אין משרות לייצוא', 'warning');
                return;
            }
            
            const jobsJson = JSON.stringify(jobs, null, 2);
            const blob = new Blob([jobsJson], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            
            const downloadLink = document.createElement('a');
            downloadLink.href = url;
            downloadLink.download = 'jobs.json';
            document.body.appendChild(downloadLink);
            downloadLink.click();
            document.body.removeChild(downloadLink);
            
            URL.revokeObjectURL(url);
            
            showNotification('קובץ ל-GitHub יוצא - עקוב אחר ההוראות', 'success');
            
            // הצגת הנחיות מפורטות
            setTimeout(() => {
                alert(`קובץ jobs.json הורד בהצלחה!

הנחיות לעדכון GitHub:
1. היכנס ל-GitHub.com
2. נווט לקובץ: data.js/jobs(1).json
3. לחץ על "Edit" (עיפרון)
4. מחק את כל התוכן הקיים
5. העתק והדבק את תוכן הקובץ החדש
6. לחץ "Commit changes"
7. המתן 2-3 דקות לסנכרון

✅ לאחר העדכון האתר יתעדכן אוטומטית!`);
            }, 1000);
        }

        function downloadAdvancedTemplate() {
            const csvContent = `מספר משרה,כותרת,חברה,קטגוריה,עיר,אזור,סוג משרה,סטטוס,תיאור,דרישות,מומלצת
JOB001,"מפתח/ת Full Stack","חברת הייטק בע״מ","פיתוח ותוכנה","תל אביב","מרכז","משרה מלאה","פעיל","פיתוח אפליקציות מתקדמות","React | Node.js | 3+ שנות ניסיון","כן"
JOB002,"מנהל/ת מכירות","חברת שיווק","שיווק ומכירות","חיפה","צפון","משרה מלאה","פעיל","ניהול צוות מכירות","ניסיון בניהול | יכולות מכירה","לא"
JOB003,"מורה לאנגלית","בית ספר","חינוך והוראה","ירושלים","ירושלים והסביבה","משרה חלקית","פעיל","הוראת אנגלית לתיכון","תואר בהוראה | אנגלית ברמה גבוהה","לא"`;
            
            const blob = new Blob(['\ufeff' + csvContent], { type: 'text/csv;charset=utf-8;' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.setAttribute('href', url);
            link.setAttribute('download', 'template_advanced.csv');
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(url);
            
            showNotification('תבנית מתקדמת הורדה בהצלחה', 'success');
        }

        // ניטור סנכרון מתקדם
        function startSyncMonitoring() {
            updateSyncPanel();
            
            // עדכון כל 30 שניות
            if (syncInterval) clearInterval(syncInterval);
            syncInterval = setInterval(() => {
                updateSyncPanel();
                checkSystemsSync();
            }, 30000);
        }

        function updateSyncPanel() {
            const now = new Date();
            
            // עדכון זמנים
            const lastUpdate = localStorage.getItem('jobs_last_updated');
            const lastCheck = localStorage.getItem('last_sync_check');
            
            document.getElementById('lastUpdate').textContent = lastUpdate ? 
                formatDateTime(lastUpdate) : 'לא ידוע';
            document.getElementById('lastCheck').textContent = lastCheck ? 
                formatDateTime(lastCheck) : 'לא ידוע';
            
            // בדיקת סטטוס מערכות
            updateSyncStatus('localStorage', !!localStorage.getItem('jobs'));
            updateSyncStatus('website', !!localStorage.getItem('website_jobs'));
        }

        function updateSyncStatus(system, isConnected, lastUpdate = null) {
            const statusElements = {
                'localStorage': 'websiteSync',
                'website': 'websiteSync', 
                'github': 'githubSync'
            };
            
            const elementId = statusElements[system];
            if (!elementId) return;
            
            const element = document.getElementById(elementId);
            if (!element) return;
            
            if (isConnected) {
                element.innerHTML = '<i class="fas fa-check-circle" style="color: #28a745;"></i> מחובר';
                if (lastUpdate) {
                    element.innerHTML += ` <small>(${formatDateTime(lastUpdate)})</small>`;
                }
            } else {
                element.innerHTML = '<i class="fas fa-exclamation-triangle" style="color: #ffc107;"></i> לא מחובר';
            }
            
            // עדכון מחוון ראשי
            updateMainSyncIndicator();
        }

        function updateMainSyncIndicator() {
            const indicator = document.getElementById('syncIndicator');
            const text = document.getElementById('syncText');
            
            const localOk = !!localStorage.getItem('jobs');
            const websiteOk = !!localStorage.getItem('website_jobs');
            
            if (localOk && websiteOk) {
                indicator.className = 'sync-indicator';
                text.textContent = 'מסונכרן';
            } else {
                indicator.className = 'sync-indicator error';
                text.textContent = 'שגיאת סנכרון';
            }
        }

        function checkSystemsSync() {
            // בדיקה אם צריך לסנכרן עם GitHub
            const lastGitHubCheck = localStorage.getItem('last_github_check');
            const now = new Date();
            
            if (!lastGitHubCheck || (now - new Date(lastGitHubCheck)) > 5 * 60 * 1000) {
                // בדיקה כל 5 דקות
                fetch('https://raw.githubusercontent.com/kerenraf/mahyeshpo-website/main/data.js/jobs(1).json')
                    .then(response => response.ok ? response.json() : Promise.reject())
                    .then(githubJobs => {
                        updateSyncStatus('github', true);
                        localStorage.setItem('last_github_check', now.toISOString());
                        
                        // השוואה עם הנתונים המקומיים
                        if (githubJobs.length !== jobs.length) {
                            showNotification(`זוהה שינוי ב-GitHub: ${githubJobs.length} משרות`, 'warning');
                        }
                    })
                    .catch(() => {
                        updateSyncStatus('github', false);
                        localStorage.setItem('last_github_check', now.toISOString());
                    });
            }
        }

        function syncAllSystems() {
            showNotification('מתחיל סנכרון מלא...', 'warning');
            showLoading();
            
            Promise.all([
                syncWithMainWebsite(),
                loadJobsAdvanced()
            ]).then(() => {
                updateSyncPanel();
                showNotification('סנכרון מלא הושלם בהצלחה!', 'success');
            }).catch(error => {
                console.error('שגיאה בסנכרון:', error);
                showNotification('שגיאה בסנכרון המערכות', 'error');
            }).finally(() => {
                hideLoading();
            });
        }

        // פונקציות עזר
        function formatDateTime(isoString) {
            try {
                const date = new Date(isoString);
                const today = new Date();
                const isToday = date.toDateString() === today.toDateString();
                
                if (isToday) {
                    return `היום ${date.getHours().toString().padStart(2, '0')}:${date.getMinutes().toString().padStart(2, '0')}`;
                } else {
                    return `${date.getDate().toString().padStart(2, '0')}/${(date.getMonth()+1).toString().padStart(2, '0')} ${date.getHours().toString().padStart(2, '0')}:${date.getMinutes().toString().padStart(2, '0')}`;
                }
            } catch (e) {
                return 'תאריך לא תקין';
            }
        }

        // הודעות מתקדמות
        function showNotification(message, type = 'success') {
            const notification = document.getElementById('notification');
            const textElement = document.getElementById('notificationText');
            
            // איקונים לפי סוג הודעה
            const icons = {
                'success': 'fas fa-check-circle',
                'error': 'fas fa-exclamation-triangle', 
                'warning': 'fas fa-exclamation-circle'
            };
            
            notification.className = `notification ${type}`;
            textElement.innerHTML = `<i class="${icons[type]}"></i> ${message}`;
            notification.style.display = 'block';
            
            // הסתרה אוטומטית
            setTimeout(() => {
                notification.style.display = 'none';
            }, type === 'error' ? 5000 : 3000);
        }

        function showLoading() {
            document.getElementById('loadingOverlay').style.display = 'flex';
        }

        function hideLoading() {
            document.getElementById('loadingOverlay').style.display = 'none';
        }

        // פונקציות מתקדמות נוספות
        function manageCategories() {
            const categories = [...new Set(jobs.map(job => job.category).filter(Boolean))].sort();
            const newCategory = prompt(`קטגוריות קיימות:\n${categories.join(', ')}\n\nהוסף קטגוריה חדשה:`);
            
            if (newCategory && newCategory.trim()) {
                showNotification(`קטגוריה "${newCategory.trim()}" נוספה`, 'success');
                // בפיתוח מלא ניתן להוסיף ניהול מתקדם יותר
            }
        }

        function bulkActions() {
            if (selectedJobs.size === 0) {
                showNotification('בחר משרות קודם', 'warning');
                return;
            }
            openBulkModal();
        }

        // בדיקת כתובת URL להצגת ממשק ניהול
        function checkUrlForAdmin() {
            const hash = window.location.hash;
            const path = window.location.pathname;
            
            if (hash === '#admin' || path.includes('admin.html') || path.includes('admin')) {
                if (sessionStorage.getItem('adminAuthenticated') === 'true') {
                    document.getElementById('adminLoginSection').style.display = 'none';
                    document.getElementById('adminContentSection').style.display = 'block';
                    document.getElementById('backToSite').style.display = 'block';
                    initializeAdminSystem();
                } else {
                    document.getElementById('adminLoginSection').style.display = 'flex';
                    document.getElementById('adminContentSection').style.display = 'none';
                }
                return true;
            }
            return false;
        }

        // אתחול האפליקציה
        document.addEventListener('DOMContentLoaded', function() {
            // בדיקת הניתוב
            if (!checkUrlForAdmin()) {
                // אם לא נכנסנו דרך ניתוב מיוחד, בדוק אימות
                if (sessionStorage.getItem('adminAuthenticated') === 'true') {
                    document.getElementById('adminLoginSection').style.display = 'none';
                    document.getElementById('adminContentSection').style.display = 'block';
                    document.getElementById('backToSite').style.display = 'block';
                    initializeAdminSystem();
                } else {
                    document.getElementById('adminLoginSection').style.display = 'flex';
                    document.getElementById('adminContentSection').style.display = 'none';
                }
            }
            
            // האזנה למקש Enter בשדה הסיסמה
            document.getElementById('adminPassword').addEventListener('keyup', function(event) {
                if (event.key === 'Enter') {
                    checkAdminPassword();
                }
            });
            
            // תמיכה ב-Drag & Drop לייבוא
            const fileUpload = document.querySelector('.file-upload');
            if (fileUpload) {
                fileUpload.addEventListener('dragover', function(e) {
                    e.preventDefault();
                    this.style.borderColor = '#ff9e9e';
                    this.style.background = 'linear-gradient(135deg, rgba(246,152,152,0.2), rgba(246,152,152,0.3))';
                });
                
                fileUpload.addEventListener('dragleave', function(e) {
                    e.preventDefault();
                    this.style.borderColor = '#F69898';
                    this.style.background = 'linear-gradient(135deg, rgba(246,152,152,0.05), rgba(246,152,152,0.1))';
                });
                
                fileUpload.addEventListener('drop', function(e) {
                    e.preventDefault();
                    this.style.borderColor = '#F69898';
                    this.style.background = 'linear-gradient(135deg, rgba(246,152,152,0.05), rgba(246,152,152,0.1))';
                    
                    const files = e.dataTransfer.files;
                    if (files.length > 0) {
                        document.getElementById('file-input').files = files;
                        handleFileUpload({ target: { files: files } });
                    }
                });
            }
        });

        // סגירת מודלים בלחיצה מחוץ לתוכן
        window.addEventListener('click', function(event) {
            const modals = ['import-modal', 'mapping-modal', 'job-edit-modal', 'bulk-modal'];
            modals.forEach(modalId => {
                const modal = document.getElementById(modalId);
                if (event.target === modal) {
                    modal.style.display = 'none';
                }
            });
        });

        // האזנה למקש ESC
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                const modals = ['import-modal', 'mapping-modal', 'job-edit-modal', 'bulk-modal'];
                modals.forEach(modalId => {
                    const modal = document.getElementById(modalId);
                    if (modal.style.display === 'block') {
                        modal.style.display = 'none';
                    }
                });
            }
        });

        // האזנה לשינויים ב-URL
        window.addEventListener('hashchange', function() {
            checkUrlForAdmin();
        });

        // פונקציות גלובליות
        window.showLoginForm = showLoginForm;
        window.checkAdminPassword = checkAdminPassword;
        window.openImportModal = openImportModal;
        window.closeImportModal = closeImportModal;
        window.handleFileUpload = handleFileUpload;
        window.openMappingModalAdvanced = openMappingModalAdvanced;
        window.closeMappingModal = closeMappingModal;
        window.applyMapping = applyMapping;
        window.openAddJobModal = openAddJobModal;
        window.closeEditModal = closeEditModal;
        window.saveJob = saveJob;
        window.toggleFeatured = toggleFeatured;
        window.editJobAdvanced = editJobAdvanced;
        window.viewJobAdvanced = viewJobAdvanced;
        window.deleteJobAdvanced = deleteJobAdvanced;
        window.toggleJobSelection = toggleJobSelection;
        window.toggleSelectAll = toggleSelectAll;
        window.toggleJobFeatured = toggleJobFeatured;
        window.filterJobsList = filterJobsList;
        window.clearJobsFilters = clearJobsFilters;
        window.openBulkModal = openBulkModal;
        window.closeBulkModal = closeBulkModal;
        window.bulkAction = bulkAction;
        window.exportJobs = exportJobs;
        window.exportForGitHub = exportForGitHub;
        window.downloadAdvancedTemplate = downloadAdvancedTemplate;
        window.manageCategories = manageCategories;
        window.bulkActions = bulkActions;
        window.syncAllSystems = syncAllSystems;

        console.log('🚀 מערכת ניהול מתקדמת נטענה בהצלחה!');
    </script>
</body>
</html>

---

## 🔐 כיצד להיכנס למערכת הניהול?

יש **3 דרכים** להיכנס למערכת הניהול:

### **דרך 1: דרך האתר הראשי**
1. היכנס לאתר הראשי שלך
2. תראה כפתור צדדי עגול עם סמל מנעול 🔒
3. לחץ על הכפתור
4. הכנס את הסיסמה: `yarin080708`

### **דרך 2: כתובת ישירה**
1. גש לכתובת: `yoursite.com/admin.html`
2. או שמור את הקובץ בשם `admin.html` באתר שלך
3. הכנס את הסיסמה: `yarin080708`

### **דרך 3: דרך ה-Hash**
1. הוסף `#admin` לכתובת האתר
2. למשל: `yoursite.com/#admin`
3. הכנס את הסיסמה: `yarin080708`

---

## ⚙️ מה תוכל לעשות במערכת הניהול?

### **ניהול משרות מתקדם:**
- ✅ הוספה, עריכה ומחיקה של משרות
- ⭐ סימון משרות כמומלצות
- 🔍 חיפוש וסינון מתקדם
- 📊 פעולות מרובות על משרות

### **ייבוא וייצוא:**
- 📁 ייבוא משרות מקבצי CSV/JSON
- 🔄 מיפוי אוטומטי של שדות
- 💾 ייצוא לקבצים
- 🌐 עדכון GitHub ישיר

### **סנכרון מערכות:**
- 🔗 סנכרון אוטומטי עם האתר הראשי
- 📡 בדיקת עדכונים מ-GitHub
- 📈 מעקב אחר סטטיסטיקות
- ⏰ ניטור בזמן אמת

---

## 🔄 איך המערכת עובדת?

1. **מערכת הניהול** שומרת את המשרות ב-`localStorage`
2. **סנכרון אוטומטי** עם האתר הראשי
3. **עדכון GitHub** ידני לפי הצורך
4. **האתר הראשי** טוען אוטומטית מ-GitHub

המערכת מבטיחה שהמשרות תמיד יהיו מעודכנות בכל המקומות! 🎯
